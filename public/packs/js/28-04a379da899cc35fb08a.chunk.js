(window.webpackJsonp=window.webpackJsonp||[]).push([[28],{2832:function(t,n,e){var o=e(13),r=e(2845);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var a={insert:"head",singleton:!1};o(r,a);t.exports=r.locals||{}},2833:function(t,n,e){var o=e(13),r=e(2847);"string"===typeof(r=r.__esModule?r.default:r)&&(r=[[t.i,r,""]]);var a={insert:"head",singleton:!1};o(r,a);t.exports=r.locals||{}},2844:function(t,n,e){"use strict";e(2832)},2845:function(t,n,e){(n=e(14)(!0)).push([t.i,"#csml-editor--frame[data-v-1da3205e] {\n  border: 0;\n  width: 100%;\n  height: 100%;\n}\n","",{version:3,sources:["/Users/s.dastan/Desktop/chatwoot/chatwoot/app/javascript/dashboard/routes/dashboard/settings/agentBots/components/app/javascript/dashboard/routes/dashboard/settings/agentBots/components/CSMLMonacoEditor.vue"],names:[],mappings:"AA+DA;EACA,SAAA;EACA,WAAA;EACA,YAAA;AACA",file:"CSMLMonacoEditor.vue",sourcesContent:["<template>\n  <div class=\"csml-editor--container\">\n    <loading-state\n      v-if=\"iframeLoading\"\n      :message=\"$t('AGENT_BOTS.LOADING_EDITOR')\"\n      class=\"dashboard-app_loading-container\"\n    />\n    <iframe\n      id=\"csml-editor--frame\"\n      :src=\"globalConfig.csmlEditorHost\"\n      @load=\"onEditorLoad\"\n    />\n  </div>\n</template>\n<script>\nimport LoadingState from 'dashboard/components/widgets/LoadingState';\nimport { mapGetters } from 'vuex';\n\nexport default {\n  components: { LoadingState },\n  props: {\n    value: {\n      type: String,\n      default: '',\n    },\n  },\n  data() {\n    return {\n      iframeLoading: true,\n    };\n  },\n  computed: {\n    ...mapGetters({\n      globalConfig: 'globalConfig/get',\n    }),\n  },\n  mounted() {\n    window.onmessage = e => {\n      if (\n        typeof e.data !== 'string' ||\n        !e.data.startsWith('chatwoot-csml-editor:update')\n      ) {\n        return;\n      }\n      const csmlContent = e.data.replace('chatwoot-csml-editor:update', '');\n      this.$emit('input', csmlContent);\n    };\n  },\n  methods: {\n    onEditorLoad() {\n      const frameElement = document.getElementById(`csml-editor--frame`);\n      const eventData = {\n        event: 'editorContext',\n        data: this.value || '',\n      };\n      frameElement.contentWindow.postMessage(JSON.stringify(eventData), '*');\n      this.iframeLoading = false;\n    },\n  },\n};\n<\/script>\n\n<style scoped>\n#csml-editor--frame {\n  border: 0;\n  width: 100%;\n  height: 100%;\n}\n</style>\n"]}]),t.exports=n},2846:function(t,n,e){"use strict";e(2833)},2847:function(t,n,e){(n=e(14)(!0)).push([t.i,".no-padding[data-v-644ddfaa] {\n  padding: 0 !important;\n}\n.full-height[data-v-644ddfaa] {\n  height: calc(100vh - 56px);\n}\n.bot-editor[data-v-644ddfaa] {\n  width: 100%;\n  height: 100%;\n}\n.details-editor[data-v-644ddfaa] {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 100%;\n}\n.editor-wrapper[data-v-644ddfaa] {\n  position: relative;\n}\n.editor-error-message[data-v-644ddfaa] {\n  position: absolute;\n  bottom: 0;\n  width: 100%;\n  padding: 1rem;\n  background-color: #e0bbbb;\n  display: flex;\n  align-items: center;\n  font-size: 1.2rem;\n  justify-content: center;\n  flex-shrink: 0;\n}\n","",{version:3,sources:["/Users/s.dastan/Desktop/chatwoot/chatwoot/app/javascript/dashboard/routes/dashboard/settings/agentBots/components/app/javascript/dashboard/routes/dashboard/settings/agentBots/components/CSMLBotEditor.vue"],names:[],mappings:"AAwFA;EACA,qBAAA;AACA;AACA;EACA,0BAAA;AACA;AAEA;EACA,WAAA;EACA,YAAA;AACA;AACA;EACA,aAAA;EACA,sBAAA;EACA,8BAAA;EACA,YAAA;AACA;AACA;EACA,kBAAA;AACA;AACA;EACA,kBAAA;EACA,SAAA;EACA,WAAA;EACA,aAAA;EACA,yBAAA;EACA,aAAA;EACA,mBAAA;EACA,iBAAA;EACA,uBAAA;EACA,cAAA;AACA",file:"CSMLBotEditor.vue",sourcesContent:['<template>\n  <div class="column content-box no-padding">\n    <div class="row">\n      <div class="small-8 columns">\n        <div class="full-height editor-wrapper">\n          <csml-monaco-editor v-model="bot.csmlContent" class="bot-editor" />\n          <div v-if="$v.bot.csmlContent.$error" class="editor-error-message">\n            <span>{{ $t(\'AGENT_BOTS.CSML_BOT_EDITOR.BOT_CONFIG.ERROR\') }}</span>\n          </div>\n        </div>\n      </div>\n      <div class="small-4 columns content-box full-height">\n        <form class="details-editor" @submit.prevent="onSubmit">\n          <div>\n            <label :class="{ error: $v.bot.name.$error }">\n              {{ $t(\'AGENT_BOTS.CSML_BOT_EDITOR.NAME.LABEL\') }}\n              <input\n                v-model="bot.name"\n                type="text"\n                :placeholder="$t(\'AGENT_BOTS.CSML_BOT_EDITOR.NAME.PLACEHOLDER\')"\n              />\n              <span v-if="$v.bot.name.$error" class="message">\n                {{ $t(\'AGENT_BOTS.CSML_BOT_EDITOR.NAME.ERROR\') }}\n              </span>\n            </label>\n            <label>\n              {{ $t(\'AGENT_BOTS.CSML_BOT_EDITOR.DESCRIPTION.LABEL\') }}\n              <textarea\n                v-model="bot.description"\n                rows="4"\n                :placeholder="\n                  $t(\'AGENT_BOTS.CSML_BOT_EDITOR.DESCRIPTION.PLACEHOLDER\')\n                "\n              />\n            </label>\n            <woot-button>\n              {{ $t(\'AGENT_BOTS.CSML_BOT_EDITOR.SUBMIT\') }}\n            </woot-button>\n          </div>\n        </form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { required } from \'vuelidate/lib/validators\';\nimport CsmlMonacoEditor from \'./CSMLMonacoEditor.vue\';\n\nexport default {\n  components: { CsmlMonacoEditor },\n  props: {\n    agentBot: {\n      type: Object,\n      default: () => {},\n    },\n  },\n  validations: {\n    bot: {\n      name: { required },\n      csmlContent: { required },\n    },\n  },\n  data() {\n    return {\n      bot: {\n        name: this.agentBot.name || \'\',\n        description: this.agentBot.description || \'\',\n        csmlContent: this.agentBot.bot_config.csml_content || \'\',\n      },\n    };\n  },\n  methods: {\n    onSubmit() {\n      this.$v.$touch();\n      if (this.$v.$invalid) {\n        return;\n      }\n      this.$emit(\'submit\', {\n        id: this.agentBot.id || \'\',\n        ...this.bot,\n      });\n    },\n  },\n};\n<\/script>\n\n<style scoped>\n.no-padding {\n  padding: 0 !important;\n}\n.full-height {\n  height: calc(100vh - 56px);\n}\n\n.bot-editor {\n  width: 100%;\n  height: 100%;\n}\n.details-editor {\n  display: flex;\n  flex-direction: column;\n  justify-content: space-between;\n  height: 100%;\n}\n.editor-wrapper {\n  position: relative;\n}\n.editor-error-message {\n  position: absolute;\n  bottom: 0;\n  width: 100%;\n  padding: 1rem;\n  background-color: #e0bbbb;\n  display: flex;\n  align-items: center;\n  font-size: 1.2rem;\n  justify-content: center;\n  flex-shrink: 0;\n}\n</style>\n']}]),t.exports=n},2859:function(t,n,e){"use strict";e(24),e(3),e(29),e(6),e(5),e(11),e(8),e(12);var o=e(17),r=(e(205),e(49),e(69),e(212)),a=e(4);function i(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function s(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var c={components:{LoadingState:r.a},props:{value:{type:String,default:""}},data:function(){return{iframeLoading:!0}},computed:function(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?i(Object(e),!0).forEach((function(n){s(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):i(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}({},Object(a.mapGetters)({globalConfig:"globalConfig/get"})),mounted:function(){var t=this;window.onmessage=function(n){if("string"===typeof n.data&&n.data.startsWith("chatwoot-csml-editor:update")){var e=n.data.replace("chatwoot-csml-editor:update","");t.$emit("input",e)}}},methods:{onEditorLoad:function(){var t=document.getElementById("csml-editor--frame"),n={event:"editorContext",data:this.value||""};t.contentWindow.postMessage(JSON.stringify(n),"*"),this.iframeLoading=!1}}},d=c,l=(e(2844),e(1));function p(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function u(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var m={components:{CsmlMonacoEditor:Object(l.a)(d,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"csml-editor--container"},[t.iframeLoading?e("loading-state",{staticClass:"dashboard-app_loading-container",attrs:{message:t.$t("AGENT_BOTS.LOADING_EDITOR")}}):t._e(),t._v(" "),e("iframe",{attrs:{id:"csml-editor--frame",src:t.globalConfig.csmlEditorHost},on:{load:t.onEditorLoad}})],1)}),[],!1,null,"1da3205e",null).exports},props:{agentBot:{type:Object,default:function(){}}},validations:{bot:{name:{required:o.required},csmlContent:{required:o.required}}},data:function(){return{bot:{name:this.agentBot.name||"",description:this.agentBot.description||"",csmlContent:this.agentBot.bot_config.csml_content||""}}},methods:{onSubmit:function(){this.$v.$touch(),this.$v.$invalid||this.$emit("submit",function(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?p(Object(e),!0).forEach((function(n){u(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):p(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}({id:this.agentBot.id||""},this.bot))}}},A=m,f=(e(2846),Object(l.a)(A,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return e("div",{staticClass:"column content-box no-padding"},[e("div",{staticClass:"row"},[e("div",{staticClass:"small-8 columns"},[e("div",{staticClass:"full-height editor-wrapper"},[e("csml-monaco-editor",{staticClass:"bot-editor",model:{value:t.bot.csmlContent,callback:function(n){t.$set(t.bot,"csmlContent",n)},expression:"bot.csmlContent"}}),t._v(" "),t.$v.bot.csmlContent.$error?e("div",{staticClass:"editor-error-message"},[e("span",[t._v(t._s(t.$t("AGENT_BOTS.CSML_BOT_EDITOR.BOT_CONFIG.ERROR")))])]):t._e()],1)]),t._v(" "),e("div",{staticClass:"small-4 columns content-box full-height"},[e("form",{staticClass:"details-editor",on:{submit:function(n){return n.preventDefault(),t.onSubmit(n)}}},[e("div",[e("label",{class:{error:t.$v.bot.name.$error}},[t._v("\n            "+t._s(t.$t("AGENT_BOTS.CSML_BOT_EDITOR.NAME.LABEL"))+"\n            "),e("input",{directives:[{name:"model",rawName:"v-model",value:t.bot.name,expression:"bot.name"}],attrs:{type:"text",placeholder:t.$t("AGENT_BOTS.CSML_BOT_EDITOR.NAME.PLACEHOLDER")},domProps:{value:t.bot.name},on:{input:function(n){n.target.composing||t.$set(t.bot,"name",n.target.value)}}}),t._v(" "),t.$v.bot.name.$error?e("span",{staticClass:"message"},[t._v("\n              "+t._s(t.$t("AGENT_BOTS.CSML_BOT_EDITOR.NAME.ERROR"))+"\n            ")]):t._e()]),t._v(" "),e("label",[t._v("\n            "+t._s(t.$t("AGENT_BOTS.CSML_BOT_EDITOR.DESCRIPTION.LABEL"))+"\n            "),e("textarea",{directives:[{name:"model",rawName:"v-model",value:t.bot.description,expression:"bot.description"}],attrs:{rows:"4",placeholder:t.$t("AGENT_BOTS.CSML_BOT_EDITOR.DESCRIPTION.PLACEHOLDER")},domProps:{value:t.bot.description},on:{input:function(n){n.target.composing||t.$set(t.bot,"description",n.target.value)}}})]),t._v(" "),e("woot-button",[t._v("\n            "+t._s(t.$t("AGENT_BOTS.CSML_BOT_EDITOR.SUBMIT"))+"\n          ")])],1)])])])])}),[],!1,null,"644ddfaa",null));n.a=f.exports},3169:function(t,n,e){"use strict";e.r(n);e(21),e(24),e(3),e(29),e(6),e(5),e(11),e(8),e(12),e(7),e(20);var o=e(65),r=e(2859),a=e(18),i=e(4);function s(t,n,e,o,r,a,i){try{var s=t[a](i),c=s.value}catch(d){return void e(d)}s.done?n(c):Promise.resolve(c).then(o,r)}function c(t,n){var e=Object.keys(t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(t);n&&(o=o.filter((function(n){return Object.getOwnPropertyDescriptor(t,n).enumerable}))),e.push.apply(e,o)}return e}function d(t){for(var n=1;n<arguments.length;n++){var e=null!=arguments[n]?arguments[n]:{};n%2?c(Object(e),!0).forEach((function(n){l(t,n,e[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):c(Object(e)).forEach((function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(e,n))}))}return t}function l(t,n,e){return n in t?Object.defineProperty(t,n,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[n]=e,t}var p={components:{Spinner:o.a,CsmlBotEditor:r.a},mixins:[a.a],computed:d(d({},Object(i.mapGetters)({uiFlags:"agentBots/uiFlags"})),{},{agentBot:function(){return this.$store.getters["agentBots/getBot"](this.$route.params.botId)}}),mounted:function(){this.$store.dispatch("agentBots/show",this.$route.params.botId)},methods:{updateBot:function(t){var n,e=this;return(n=regeneratorRuntime.mark((function n(){return regeneratorRuntime.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.$store.dispatch("agentBots/update",{id:t.id,name:t.name,description:t.description,bot_type:"csml",bot_config:{csml_content:t.csmlContent}});case 3:e.showAlert(e.$t("AGENT_BOTS.EDIT.API.SUCCESS_MESSAGE")),n.next=9;break;case 6:n.prev=6,n.t0=n.catch(0),e.showAlert(e.$t("AGENT_BOTS.CSML_BOT_EDITOR.BOT_CONFIG.API_ERROR"));case 9:case"end":return n.stop()}}),n,null,[[0,6]])})),function(){var t=this,e=arguments;return new Promise((function(o,r){var a=n.apply(t,e);function i(t){s(a,o,r,i,c,"next",t)}function c(t){s(a,o,r,i,c,"throw",t)}i(void 0)}))})()}}},u=p,m=e(1),A=Object(m.a)(u,(function(){var t=this,n=t.$createElement,e=t._self._c||n;return t.agentBot.id?e("csml-bot-editor",{attrs:{"agent-bot":t.agentBot},on:{submit:t.updateBot}}):e("div",{staticClass:"column content-box no-padding"},[e("spinner")],1)}),[],!1,null,null,null);n.default=A.exports}}]);
//# sourceMappingURL=28-04a379da899cc35fb08a.chunk.js.map