{"code":"(window.webpackJsonp=window.webpackJsonp||[]).push([[11],{3144:function(n,e,t){\"use strict\";t.r(e),t.d(e,\"schemaFilter\",(function(){return r}));var i=t(16);function r(n,e){function t(t){var r=n,o=t.event.event;if(r&&o){var a=r[o];if(!1===(null===a||void 0===a?void 0:a.enabled))return t.updateEvent(\"integrations\",Object(i.a)(Object(i.a)({},t.event.integrations),{All:!1,\"Segment.io\":!0})),t;var u=function(n,e){var t,i;if(!n||!Object.keys(n))return{};var r=Object.keys(n.integrations).filter((function(e){return!1===n.integrations[e]})),o=[];return(null!==(t=e.remotePlugins)&&void 0!==t?t:[]).forEach((function(n){r.forEach((function(e){(n.name.includes(e)||e.includes(n.name))&&o.push(n.name)}))})),(null!==(i=e.remotePlugins)&&void 0!==i?i:[]).reduce((function(n,e){return e.settings.subscriptions&&o.includes(e.name)&&e.settings.subscriptions.forEach((function(t){return n[e.name+\" \"+t.partnerAction]=!1})),n}),{})}(a,e);t.updateEvent(\"integrations\",Object(i.a)(Object(i.a)(Object(i.a)({},t.event.integrations),null===a||void 0===a?void 0:a.integrations),u))}return t}return{name:\"Schema Filter\",version:\"0.1.0\",isLoaded:function(){return!0},load:function(){return Promise.resolve()},type:\"before\",page:t,alias:t,track:t,identify:t,group:t}}}}]);","name":"js/schemaFilter-32708e03d809c645a4ca.chunk.js","map":{"version":3,"names":["window","push","module","__webpack_exports__","__webpack_require__","r","d","schemaFilter","tslib__WEBPACK_IMPORTED_MODULE_0__","track","settings","filter","ctx","plan","ev","event","planEvent","enabled","updateEvent","Object","integrations","All","disabledActions","_a","_b","keys","disabledIntegrations","i","disabledRemotePlugins","remotePlugins","forEach","p","int","name","includes","reduce","acc","sub","partnerAction","disabledActionDestinations","version","isLoaded","load","Promise","resolve","type","page","alias","identify","group"],"sources":["js/schemaFilter-32708e03d809c645a4ca.chunk.js"],"mappings":"CAACA,OAAqB,aAAIA,OAAqB,cAAK,IAAIC,KAAK,CAAC,CAAC,IAAI,CAE7D,KACA,SAAUC,EAAQC,EAAqBC,GAE7C,aACAA,EAAoBC,EAAEF,GACSC,EAAoBE,EAAEH,EAAqB,gBAAgB,WAAa,OAAOI,KACzF,IAAIC,EAAqCJ,EAAoB,IAuClF,SAASG,EAAaE,EAAOC,GAC3B,SAASC,EAAOC,GACd,IAAIC,EAAOJ,EACPK,EAAKF,EAAIG,MAAMA,MAEnB,GAAIF,GAAQC,EAAI,CACd,IAAIE,EAAYH,EAAKC,GAErB,IAAkF,KAA/D,OAAdE,QAAoC,IAAdA,OAAuB,EAASA,EAAUC,SAKnE,OAJAL,EAAIM,YAAY,eAAgBC,OAAOX,EAAqD,EAA5DW,CAA+DA,OAAOX,EAAqD,EAA5DW,CAA+D,GAAIP,EAAIG,MAAMK,cAAe,CACzLC,KAAK,EACL,cAAc,KAETT,EAEP,IAAIU,EAnDZ,SAAoCT,EAAMH,GACxC,IAAIa,EAAIC,EAER,IAAKX,IAASM,OAAOM,KAAKZ,GACxB,MAAO,GAGT,IAAIa,EAAuBP,OAAOM,KAAKZ,EAAKO,cAAcT,QAAO,SAAUgB,GACzE,OAAgC,IAAzBd,EAAKO,aAAaO,MAIvBC,EAAwB,GAQ5B,OAPmC,QAAjCL,EAAKb,EAASmB,qBAAkC,IAAPN,EAAgBA,EAAK,IAAIO,SAAQ,SAAUC,GACpFL,EAAqBI,SAAQ,SAAUE,IACjCD,EAAEE,KAAKC,SAASF,IAAQA,EAAIE,SAASH,EAAEE,QACzCL,EAAsB3B,KAAK8B,EAAEE,aAIO,QAAjCT,EAAKd,EAASmB,qBAAkC,IAAPL,EAAgBA,EAAK,IAAIW,QAAO,SAAUC,EAAKL,GAY/F,OAVIA,EAAErB,SAAwB,eACxBkB,EAAsBM,SAASH,EAAEE,OAEnCF,EAAErB,SAAwB,cAAEoB,SAC5B,SAAUO,GACR,OAAOD,EAAIL,EAAEE,KAAO,IAAMI,EAAIC,gBAAiB,KAK9CF,IACN,IAkByBG,CAA2BvB,EAAWN,GAC5DE,EAAIM,YAAY,eAAgBC,OAAOX,EAAqD,EAA5DW,CAA+DA,OAAOX,EAAqD,EAA5DW,CAA+DA,OAAOX,EAAqD,EAA5DW,CAA+D,GAAIP,EAAIG,MAAMK,cAA6B,OAAdJ,QAAoC,IAAdA,OAAuB,EAASA,EAAUI,cAAeE,IAI7U,OAAOV,EAGT,MAAO,CACLqB,KAAM,gBACNO,QAAS,QACTC,SAAU,WACR,OAAO,GAETC,KAAM,WACJ,OAAOC,QAAQC,WAEjBC,KAAM,SACNC,KAAMnC,EACNoC,MAAOpC,EACPF,MAAOE,EACPqC,SAAUrC,EACVsC,MAAOtC"},"input":"(window[\"webpackJsonp\"] = window[\"webpackJsonp\"] || []).push([[11],{\n\n/***/ 3144:\n/***/ (function(module, __webpack_exports__, __webpack_require__) {\n\n\"use strict\";\n__webpack_require__.r(__webpack_exports__);\n/* harmony export (binding) */ __webpack_require__.d(__webpack_exports__, \"schemaFilter\", function() { return schemaFilter; });\n/* harmony import */ var tslib__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(16);\n\n\nfunction disabledActionDestinations(plan, settings) {\n  var _a, _b;\n\n  if (!plan || !Object.keys(plan)) {\n    return {};\n  }\n\n  var disabledIntegrations = Object.keys(plan.integrations).filter(function (i) {\n    return plan.integrations[i] === false;\n  }); // This accounts for cases like Fullstory, where the settings.integrations\n  // contains a \"Fullstory\" object but settings.remotePlugins contains \"Fullstory (Actions)\"\n\n  var disabledRemotePlugins = [];\n  ((_a = settings.remotePlugins) !== null && _a !== void 0 ? _a : []).forEach(function (p) {\n    disabledIntegrations.forEach(function (int) {\n      if (p.name.includes(int) || int.includes(p.name)) {\n        disabledRemotePlugins.push(p.name);\n      }\n    });\n  });\n  return ((_b = settings.remotePlugins) !== null && _b !== void 0 ? _b : []).reduce(function (acc, p) {\n    // @ts-expect-error element implicitly has an 'any' type because p.settings is a JSONValue\n    if (p.settings['subscriptions']) {\n      if (disabledRemotePlugins.includes(p.name)) {\n        // @ts-expect-error element implicitly has an 'any' type because p.settings is a JSONValue\n        p.settings['subscriptions'].forEach( // @ts-expect-error parameter 'sub' implicitly has an 'any' type\n        function (sub) {\n          return acc[p.name + \" \" + sub.partnerAction] = false;\n        });\n      }\n    }\n\n    return acc;\n  }, {});\n}\n\nfunction schemaFilter(track, settings) {\n  function filter(ctx) {\n    var plan = track;\n    var ev = ctx.event.event;\n\n    if (plan && ev) {\n      var planEvent = plan[ev];\n\n      if ((planEvent === null || planEvent === void 0 ? void 0 : planEvent.enabled) === false) {\n        ctx.updateEvent('integrations', Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __assign */ \"a\"])(Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __assign */ \"a\"])({}, ctx.event.integrations), {\n          All: false,\n          'Segment.io': true\n        }));\n        return ctx;\n      } else {\n        var disabledActions = disabledActionDestinations(planEvent, settings);\n        ctx.updateEvent('integrations', Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __assign */ \"a\"])(Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __assign */ \"a\"])(Object(tslib__WEBPACK_IMPORTED_MODULE_0__[/* __assign */ \"a\"])({}, ctx.event.integrations), planEvent === null || planEvent === void 0 ? void 0 : planEvent.integrations), disabledActions));\n      }\n    }\n\n    return ctx;\n  }\n\n  return {\n    name: 'Schema Filter',\n    version: '0.1.0',\n    isLoaded: function isLoaded() {\n      return true;\n    },\n    load: function load() {\n      return Promise.resolve();\n    },\n    type: 'before',\n    page: filter,\n    alias: filter,\n    track: filter,\n    identify: filter,\n    group: filter\n  };\n}\n\n/***/ })\n\n}]);","inputSourceMap":{"version":3,"sources":["/Users/s.dastan/Desktop/chatwoot/chatwoot/node_modules/babel-loader/lib/index.js??ref--6-0!/Users/s.dastan/Desktop/chatwoot/chatwoot/node_modules/@june-so/analytics-next/dist/pkg/plugins/schema-filter/index.js"],"names":[],"mappings":";;;;;;AAAA;AAAA;AAAA;AAAiC;;AAEjC;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,GAAG,EAAE;AACL;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL,GAAG;AACH;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;;AAEA;AACA,GAAG,IAAI;AACP;;AAEO;AACP;AACA;AACA;;AAEA;AACA;;AAEA;AACA,wCAAwC,8DAAQ,CAAC,8DAAQ,GAAG;AAC5D;AACA;AACA,SAAS;AACT;AACA,OAAO;AACP;AACA,wCAAwC,8DAAQ,CAAC,8DAAQ,CAAC,8DAAQ,GAAG;AACrE;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA;AACA;AACA;AACA,C","file":"x","sourcesContent":["import { __assign } from \"tslib\";\n\nfunction disabledActionDestinations(plan, settings) {\n  var _a, _b;\n\n  if (!plan || !Object.keys(plan)) {\n    return {};\n  }\n\n  var disabledIntegrations = Object.keys(plan.integrations).filter(function (i) {\n    return plan.integrations[i] === false;\n  }); // This accounts for cases like Fullstory, where the settings.integrations\n  // contains a \"Fullstory\" object but settings.remotePlugins contains \"Fullstory (Actions)\"\n\n  var disabledRemotePlugins = [];\n  ((_a = settings.remotePlugins) !== null && _a !== void 0 ? _a : []).forEach(function (p) {\n    disabledIntegrations.forEach(function (int) {\n      if (p.name.includes(int) || int.includes(p.name)) {\n        disabledRemotePlugins.push(p.name);\n      }\n    });\n  });\n  return ((_b = settings.remotePlugins) !== null && _b !== void 0 ? _b : []).reduce(function (acc, p) {\n    // @ts-expect-error element implicitly has an 'any' type because p.settings is a JSONValue\n    if (p.settings['subscriptions']) {\n      if (disabledRemotePlugins.includes(p.name)) {\n        // @ts-expect-error element implicitly has an 'any' type because p.settings is a JSONValue\n        p.settings['subscriptions'].forEach( // @ts-expect-error parameter 'sub' implicitly has an 'any' type\n        function (sub) {\n          return acc[p.name + \" \" + sub.partnerAction] = false;\n        });\n      }\n    }\n\n    return acc;\n  }, {});\n}\n\nexport function schemaFilter(track, settings) {\n  function filter(ctx) {\n    var plan = track;\n    var ev = ctx.event.event;\n\n    if (plan && ev) {\n      var planEvent = plan[ev];\n\n      if ((planEvent === null || planEvent === void 0 ? void 0 : planEvent.enabled) === false) {\n        ctx.updateEvent('integrations', __assign(__assign({}, ctx.event.integrations), {\n          All: false,\n          'Segment.io': true\n        }));\n        return ctx;\n      } else {\n        var disabledActions = disabledActionDestinations(planEvent, settings);\n        ctx.updateEvent('integrations', __assign(__assign(__assign({}, ctx.event.integrations), planEvent === null || planEvent === void 0 ? void 0 : planEvent.integrations), disabledActions));\n      }\n    }\n\n    return ctx;\n  }\n\n  return {\n    name: 'Schema Filter',\n    version: '0.1.0',\n    isLoaded: function isLoaded() {\n      return true;\n    },\n    load: function load() {\n      return Promise.resolve();\n    },\n    type: 'before',\n    page: filter,\n    alias: filter,\n    track: filter,\n    identify: filter,\n    group: filter\n  };\n}"]}}