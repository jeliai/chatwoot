{"ast":null,"code":"import \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mixin as clickaway } from 'vue-clickaway';\nimport SearchSuggestions from './SearchSuggestions';\nimport PublicSearchInput from './PublicSearchInput';\nimport ArticlesAPI from '../api/article';\nexport default {\n  components: {\n    PublicSearchInput: PublicSearchInput,\n    SearchSuggestions: SearchSuggestions\n  },\n  mixins: [clickaway],\n  props: {\n    value: {\n      type: [String, Number],\n      default: ''\n    }\n  },\n  data: function data() {\n    return {\n      searchTerm: '',\n      isLoading: false,\n      showSearchBox: false,\n      searchResults: []\n    };\n  },\n  computed: {\n    portalSlug: function portalSlug() {\n      return window.portalConfig.portalSlug;\n    },\n    localeCode: function localeCode() {\n      return window.portalConfig.localeCode;\n    },\n    shouldShowSearchBox: function shouldShowSearchBox() {\n      return this.searchTerm !== '' && this.showSearchBox;\n    },\n    searchTranslations: function searchTranslations() {\n      var _window$portalConfig$ = window.portalConfig.searchTranslations,\n          searchTranslations = _window$portalConfig$ === void 0 ? {} : _window$portalConfig$;\n      return searchTranslations;\n    }\n  },\n  watch: {\n    searchTerm: function searchTerm() {\n      var _this = this;\n\n      if (this.typingTimer) {\n        clearTimeout(this.typingTimer);\n      }\n\n      this.openSearch();\n      this.isLoading = true;\n      this.typingTimer = setTimeout(function () {\n        _this.fetchArticlesByQuery();\n      }, 1000);\n    },\n    currentPage: function currentPage() {\n      this.clearSearchTerm();\n    }\n  },\n  methods: {\n    onChange: function onChange(e) {\n      this.$emit('input', e.target.value);\n    },\n    onBlur: function onBlur(e) {\n      this.$emit('blur', e.target.value);\n    },\n    openSearch: function openSearch() {\n      this.showSearchBox = true;\n    },\n    closeSearch: function closeSearch() {\n      this.showSearchBox = false;\n    },\n    clearSearchTerm: function clearSearchTerm() {\n      this.searchTerm = '';\n    },\n    fetchArticlesByQuery: function fetchArticlesByQuery() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var _yield$ArticlesAPI$se, data;\n\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _this2.isLoading = true;\n                _this2.searchResults = [];\n                _context.next = 5;\n                return ArticlesAPI.searchArticles(_this2.portalSlug, _this2.localeCode, _this2.searchTerm);\n\n              case 5:\n                _yield$ArticlesAPI$se = _context.sent;\n                data = _yield$ArticlesAPI$se.data;\n                _this2.searchResults = data.payload;\n                _this2.isLoading = true;\n                _context.next = 13;\n                break;\n\n              case 11:\n                _context.prev = 11;\n                _context.t0 = _context[\"catch\"](0);\n\n              case 13:\n                _context.prev = 13;\n                _this2.isLoading = false;\n                return _context.finish(13);\n\n              case 16:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 11, 13, 16]]);\n      }))();\n    }\n  }\n};","map":{"version":3,"sources":["PublicArticleSearch.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div\n    v-on-clickaway=\"closeSearch\"\n    class=\"mx-auto max-w-md w-full relative my-4\"\n  >\n    <public-search-input\n      v-model=\"searchTerm\"\n      :search-placeholder=\"searchTranslations.searchPlaceholder\"\n      @focus=\"openSearch\"\n    />\n    <div\n      v-if=\"shouldShowSearchBox\"\n      class=\"absolute show-search-box w-full\"\n      @mouseover=\"openSearch\"\n    >\n      <search-suggestions\n        :items=\"searchResults\"\n        :is-loading=\"isLoading\"\n        :empty-placeholder=\"searchTranslations.emptyPlaceholder\"\n        :results-title=\"searchTranslations.resultsTitle\"\n        :loading-placeholder=\"searchTranslations.loadingPlaceholder\"\n      />\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mixin as clickaway } from 'vue-clickaway';\n\nimport SearchSuggestions from './SearchSuggestions';\nimport PublicSearchInput from './PublicSearchInput';\n\nimport ArticlesAPI from '../api/article';\n\nexport default {\n  components: {\n    PublicSearchInput,\n    SearchSuggestions,\n  },\n  mixins: [clickaway],\n  props: {\n    value: {\n      type: [String, Number],\n      default: '',\n    },\n  },\n  data() {\n    return {\n      searchTerm: '',\n      isLoading: false,\n      showSearchBox: false,\n      searchResults: [],\n    };\n  },\n\n  computed: {\n    portalSlug() {\n      return window.portalConfig.portalSlug;\n    },\n    localeCode() {\n      return window.portalConfig.localeCode;\n    },\n    shouldShowSearchBox() {\n      return this.searchTerm !== '' && this.showSearchBox;\n    },\n    searchTranslations() {\n      const { searchTranslations = {} } = window.portalConfig;\n      return searchTranslations;\n    },\n  },\n\n  watch: {\n    searchTerm() {\n      if (this.typingTimer) {\n        clearTimeout(this.typingTimer);\n      }\n\n      this.openSearch();\n      this.isLoading = true;\n      this.typingTimer = setTimeout(() => {\n        this.fetchArticlesByQuery();\n      }, 1000);\n    },\n    currentPage() {\n      this.clearSearchTerm();\n    },\n  },\n\n  methods: {\n    onChange(e) {\n      this.$emit('input', e.target.value);\n    },\n    onBlur(e) {\n      this.$emit('blur', e.target.value);\n    },\n    openSearch() {\n      this.showSearchBox = true;\n    },\n    closeSearch() {\n      this.showSearchBox = false;\n    },\n    clearSearchTerm() {\n      this.searchTerm = '';\n    },\n    async fetchArticlesByQuery() {\n      try {\n        this.isLoading = true;\n        this.searchResults = [];\n        const { data } = await ArticlesAPI.searchArticles(\n          this.portalSlug,\n          this.localeCode,\n          this.searchTerm\n        );\n        this.searchResults = data.payload;\n        this.isLoading = true;\n      } catch (error) {\n        // Show something wrong message\n      } finally {\n        this.isLoading = false;\n      }\n    },\n  },\n};\n</script>\n<style lang=\"scss\" scoped>\n.show-search-box {\n  top: 4rem;\n}\n</style>\n"],"sourceRoot":"app/javascript/portal/components"},"metadata":{},"sourceType":"module"}