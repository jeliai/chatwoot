{"ast":null,"code":"function _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nimport \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.replace.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptors.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.array.slice.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters } from 'vuex';\nimport Spinner from 'shared/components/Spinner';\nimport alertMixin from 'shared/mixins/alertMixin';\nimport router from '../../../../index';\nimport PageHeader from '../../SettingsSubPageHeader';\nimport AgentSelector from '../AgentSelector';\nexport default {\n  components: {\n    Spinner: Spinner,\n    PageHeader: PageHeader,\n    AgentSelector: AgentSelector\n  },\n  mixins: [alertMixin],\n  props: {\n    team: {\n      type: Object,\n      default: function _default() {}\n    }\n  },\n  validations: {\n    selectedAgents: {\n      isEmpty: function isEmpty() {\n        return !!this.selectedAgents.length;\n      }\n    }\n  },\n  data: function data() {\n    return {\n      selectedAgents: [],\n      isCreating: false\n    };\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters({\n    agentList: 'agents/getAgents',\n    uiFlags: 'teamMembers/getUIFlags'\n  })), {}, {\n    teamId: function teamId() {\n      return this.$route.params.teamId;\n    },\n    headerTitle: function headerTitle() {\n      return this.$t('TEAMS_SETTINGS.EDIT_FLOW.AGENTS.TITLE', {\n        teamName: this.currentTeam.name\n      });\n    },\n    currentTeam: function currentTeam() {\n      return this.$store.getters['teams/getTeam'](this.teamId);\n    },\n    teamMembers: function teamMembers() {\n      return this.$store.getters['teamMembers/getTeamMembers'](this.teamId);\n    },\n    showAgentsList: function showAgentsList() {\n      var id = this.currentTeam.id;\n      return id && !this.uiFlags.isFetching;\n    }\n  }),\n  mounted: function mounted() {\n    var _this = this;\n\n    return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n      var teamId, members;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              teamId = _this.$route.params.teamId;\n\n              _this.$store.dispatch('agents/get');\n\n              _context.prev = 2;\n              _context.next = 5;\n              return _this.$store.dispatch('teamMembers/get', {\n                teamId: teamId\n              });\n\n            case 5:\n              members = _this.teamMembers.map(function (item) {\n                return item.id;\n              });\n\n              _this.updateSelectedAgents(members);\n\n              _context.next = 12;\n              break;\n\n            case 9:\n              _context.prev = 9;\n              _context.t0 = _context[\"catch\"](2);\n\n              _this.updateSelectedAgents([]);\n\n            case 12:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 9]]);\n    }))();\n  },\n  methods: {\n    updateSelectedAgents: function updateSelectedAgents(newAgentList) {\n      this.$v.selectedAgents.$touch();\n      this.selectedAgents = _toConsumableArray(newAgentList);\n    },\n    addAgents: function addAgents() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var teamId, selectedAgents;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                _this2.isCreating = true;\n                teamId = _this2.teamId, selectedAgents = _this2.selectedAgents;\n                _context2.prev = 2;\n                _context2.next = 5;\n                return _this2.$store.dispatch('teamMembers/update', {\n                  teamId: teamId,\n                  agentsList: selectedAgents\n                });\n\n              case 5:\n                router.replace({\n                  name: 'settings_teams_edit_finish',\n                  params: {\n                    page: 'edit',\n                    teamId: teamId\n                  }\n                });\n\n                _this2.$store.dispatch('teams/get');\n\n                _context2.next = 12;\n                break;\n\n              case 9:\n                _context2.prev = 9;\n                _context2.t0 = _context2[\"catch\"](2);\n\n                _this2.showAlert(_context2.t0.message);\n\n              case 12:\n                _this2.isCreating = false;\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[2, 9]]);\n      }))();\n    }\n  }\n};","map":{"version":3,"sources":["EditAgents.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"wizard-body columns content-box small-9\">\n    <form class=\"row\" @submit.prevent=\"addAgents\">\n      <div class=\"medium-12 columns\">\n        <page-header\n          :header-title=\"headerTitle\"\n          :header-content=\"$t('TEAMS_SETTINGS.EDIT_FLOW.AGENTS.DESC')\"\n        />\n      </div>\n\n      <div class=\"medium-12 columns\">\n        <div v-if=\"$v.selectedAgents.$error\">\n          <p class=\"error-message\">\n            {{ $t('TEAMS_SETTINGS.ADD.AGENT_VALIDATION_ERROR') }}\n          </p>\n        </div>\n        <agent-selector\n          v-if=\"showAgentsList\"\n          :agent-list=\"agentList\"\n          :selected-agents=\"selectedAgents\"\n          :update-selected-agents=\"updateSelectedAgents\"\n          :is-working=\"isCreating\"\n          :submit-button-text=\"\n            $t('TEAMS_SETTINGS.EDIT_FLOW.AGENTS.BUTTON_TEXT')\n          \"\n        />\n        <spinner v-else />\n      </div>\n    </form>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex';\nimport Spinner from 'shared/components/Spinner';\nimport alertMixin from 'shared/mixins/alertMixin';\n\nimport router from '../../../../index';\nimport PageHeader from '../../SettingsSubPageHeader';\nimport AgentSelector from '../AgentSelector';\n\nexport default {\n  components: {\n    Spinner,\n    PageHeader,\n    AgentSelector,\n  },\n  mixins: [alertMixin],\n\n  props: {\n    team: {\n      type: Object,\n      default: () => {},\n    },\n  },\n  validations: {\n    selectedAgents: {\n      isEmpty() {\n        return !!this.selectedAgents.length;\n      },\n    },\n  },\n\n  data() {\n    return {\n      selectedAgents: [],\n      isCreating: false,\n    };\n  },\n\n  computed: {\n    ...mapGetters({\n      agentList: 'agents/getAgents',\n      uiFlags: 'teamMembers/getUIFlags',\n    }),\n\n    teamId() {\n      return this.$route.params.teamId;\n    },\n    headerTitle() {\n      return this.$t('TEAMS_SETTINGS.EDIT_FLOW.AGENTS.TITLE', {\n        teamName: this.currentTeam.name,\n      });\n    },\n    currentTeam() {\n      return this.$store.getters['teams/getTeam'](this.teamId);\n    },\n    teamMembers() {\n      return this.$store.getters['teamMembers/getTeamMembers'](this.teamId);\n    },\n    showAgentsList() {\n      const { id } = this.currentTeam;\n      return id && !this.uiFlags.isFetching;\n    },\n  },\n\n  async mounted() {\n    const { teamId } = this.$route.params;\n    this.$store.dispatch('agents/get');\n    try {\n      await this.$store.dispatch('teamMembers/get', {\n        teamId,\n      });\n      const members = this.teamMembers.map(item => item.id);\n      this.updateSelectedAgents(members);\n    } catch {\n      this.updateSelectedAgents([]);\n    }\n  },\n\n  methods: {\n    updateSelectedAgents(newAgentList) {\n      this.$v.selectedAgents.$touch();\n      this.selectedAgents = [...newAgentList];\n    },\n    async addAgents() {\n      this.isCreating = true;\n      const { teamId, selectedAgents } = this;\n\n      try {\n        await this.$store.dispatch('teamMembers/update', {\n          teamId,\n          agentsList: selectedAgents,\n        });\n        router.replace({\n          name: 'settings_teams_edit_finish',\n          params: {\n            page: 'edit',\n            teamId,\n          },\n        });\n        this.$store.dispatch('teams/get');\n      } catch (error) {\n        this.showAlert(error.message);\n      }\n      this.isCreating = false;\n    },\n  },\n};\n</script>\n"],"sourceRoot":"app/javascript/dashboard/routes/dashboard/settings/teams/Edit"},"metadata":{},"sourceType":"module"}