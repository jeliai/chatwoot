{"ast":null,"code":"function _typeof(obj) { \"@babel/helpers - typeof\"; if (typeof Symbol === \"function\" && typeof Symbol.iterator === \"symbol\") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === \"function\" && obj.constructor === Symbol && obj !== Symbol.prototype ? \"symbol\" : typeof obj; }; } return _typeof(obj); }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }\n\nfunction _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function\"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }\n\nfunction _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }\n\nfunction _createSuper(Derived) { var hasNativeReflectConstruct = _isNativeReflectConstruct(); return function _createSuperInternal() { var Super = _getPrototypeOf(Derived), result; if (hasNativeReflectConstruct) { var NewTarget = _getPrototypeOf(this).constructor; result = Reflect.construct(Super, arguments, NewTarget); } else { result = Super.apply(this, arguments); } return _possibleConstructorReturn(this, result); }; }\n\nfunction _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === \"object\" || typeof call === \"function\")) { return call; } return _assertThisInitialized(self); }\n\nfunction _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return self; }\n\nfunction _isNativeReflectConstruct() { if (typeof Reflect === \"undefined\" || !Reflect.construct) return false; if (Reflect.construct.sham) return false; if (typeof Proxy === \"function\") return true; try { Boolean.prototype.valueOf.call(Reflect.construct(Boolean, [], function () {})); return true; } catch (e) { return false; } }\n\nfunction _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }\n\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.get-prototype-of.js\";\nimport \"core-js/modules/es.reflect.construct.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\n\n/* eslint no-console: 0 */\n\n/* global axios */\nimport ApiClient from '../ApiClient';\nexport var buildCreatePayload = function buildCreatePayload(_ref) {\n  var message = _ref.message,\n      isPrivate = _ref.isPrivate,\n      contentAttributes = _ref.contentAttributes,\n      echoId = _ref.echoId,\n      files = _ref.files,\n      _ref$ccEmails = _ref.ccEmails,\n      ccEmails = _ref$ccEmails === void 0 ? '' : _ref$ccEmails,\n      _ref$bccEmails = _ref.bccEmails,\n      bccEmails = _ref$bccEmails === void 0 ? '' : _ref$bccEmails,\n      templateParams = _ref.templateParams;\n  var payload;\n\n  if (files && files.length !== 0) {\n    payload = new FormData();\n\n    if (message) {\n      payload.append('content', message);\n    }\n\n    files.forEach(function (file) {\n      payload.append('attachments[]', file);\n    });\n    payload.append('private', isPrivate);\n    payload.append('echo_id', echoId);\n    payload.append('cc_emails', ccEmails);\n    payload.append('bcc_emails', bccEmails);\n  } else {\n    payload = {\n      content: message,\n      private: isPrivate,\n      echo_id: echoId,\n      content_attributes: contentAttributes,\n      cc_emails: ccEmails,\n      bcc_emails: bccEmails,\n      template_params: templateParams\n    };\n  }\n\n  return payload;\n};\n\nvar MessageApi = /*#__PURE__*/function (_ApiClient) {\n  _inherits(MessageApi, _ApiClient);\n\n  var _super = _createSuper(MessageApi);\n\n  function MessageApi() {\n    _classCallCheck(this, MessageApi);\n\n    return _super.call(this, 'conversations', {\n      accountScoped: true\n    });\n  }\n\n  _createClass(MessageApi, [{\n    key: \"create\",\n    value: function create(_ref2) {\n      var conversationId = _ref2.conversationId,\n          message = _ref2.message,\n          isPrivate = _ref2.private,\n          contentAttributes = _ref2.contentAttributes,\n          echoId = _ref2.echo_id,\n          files = _ref2.files,\n          _ref2$ccEmails = _ref2.ccEmails,\n          ccEmails = _ref2$ccEmails === void 0 ? '' : _ref2$ccEmails,\n          _ref2$bccEmails = _ref2.bccEmails,\n          bccEmails = _ref2$bccEmails === void 0 ? '' : _ref2$bccEmails,\n          templateParams = _ref2.templateParams;\n      return axios({\n        method: 'post',\n        url: \"\".concat(this.url, \"/\").concat(conversationId, \"/messages\"),\n        data: buildCreatePayload({\n          message: message,\n          isPrivate: isPrivate,\n          contentAttributes: contentAttributes,\n          echoId: echoId,\n          files: files,\n          ccEmails: ccEmails,\n          bccEmails: bccEmails,\n          templateParams: templateParams\n        })\n      });\n    }\n  }, {\n    key: \"delete\",\n    value: function _delete(conversationID, messageId) {\n      return axios.delete(\"\".concat(this.url, \"/\").concat(conversationID, \"/messages/\").concat(messageId));\n    }\n  }, {\n    key: \"getPreviousMessages\",\n    value: function getPreviousMessages(_ref3) {\n      var conversationId = _ref3.conversationId,\n          before = _ref3.before;\n      return axios.get(\"\".concat(this.url, \"/\").concat(conversationId, \"/messages\"), {\n        params: {\n          before: before\n        }\n      });\n    }\n  }]);\n\n  return MessageApi;\n}(ApiClient);\n\nexport default new MessageApi();","map":{"version":3,"sources":["/Users/s.dastan/Desktop/chatwoot/chatwoot/app/javascript/dashboard/api/inbox/message.js"],"names":["ApiClient","buildCreatePayload","message","isPrivate","contentAttributes","echoId","files","ccEmails","bccEmails","templateParams","payload","length","FormData","append","forEach","file","content","private","echo_id","content_attributes","cc_emails","bcc_emails","template_params","MessageApi","accountScoped","conversationId","axios","method","url","data","conversationID","messageId","delete","before","get","params"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAAA;;AACA;AACA,OAAOA,SAAP,MAAsB,cAAtB;AAEA,OAAO,IAAMC,kBAAkB,GAAG,SAArBA,kBAAqB,OAS5B;AAAA,MARJC,OAQI,QARJA,OAQI;AAAA,MAPJC,SAOI,QAPJA,SAOI;AAAA,MANJC,iBAMI,QANJA,iBAMI;AAAA,MALJC,MAKI,QALJA,MAKI;AAAA,MAJJC,KAII,QAJJA,KAII;AAAA,2BAHJC,QAGI;AAAA,MAHJA,QAGI,8BAHO,EAGP;AAAA,4BAFJC,SAEI;AAAA,MAFJA,SAEI,+BAFQ,EAER;AAAA,MADJC,cACI,QADJA,cACI;AACJ,MAAIC,OAAJ;;AACA,MAAIJ,KAAK,IAAIA,KAAK,CAACK,MAAN,KAAiB,CAA9B,EAAiC;AAC/BD,IAAAA,OAAO,GAAG,IAAIE,QAAJ,EAAV;;AACA,QAAIV,OAAJ,EAAa;AACXQ,MAAAA,OAAO,CAACG,MAAR,CAAe,SAAf,EAA0BX,OAA1B;AACD;;AACDI,IAAAA,KAAK,CAACQ,OAAN,CAAc,UAAAC,IAAI,EAAI;AACpBL,MAAAA,OAAO,CAACG,MAAR,CAAe,eAAf,EAAgCE,IAAhC;AACD,KAFD;AAGAL,IAAAA,OAAO,CAACG,MAAR,CAAe,SAAf,EAA0BV,SAA1B;AACAO,IAAAA,OAAO,CAACG,MAAR,CAAe,SAAf,EAA0BR,MAA1B;AACAK,IAAAA,OAAO,CAACG,MAAR,CAAe,WAAf,EAA4BN,QAA5B;AACAG,IAAAA,OAAO,CAACG,MAAR,CAAe,YAAf,EAA6BL,SAA7B;AACD,GAZD,MAYO;AACLE,IAAAA,OAAO,GAAG;AACRM,MAAAA,OAAO,EAAEd,OADD;AAERe,MAAAA,OAAO,EAAEd,SAFD;AAGRe,MAAAA,OAAO,EAAEb,MAHD;AAIRc,MAAAA,kBAAkB,EAAEf,iBAJZ;AAKRgB,MAAAA,SAAS,EAAEb,QALH;AAMRc,MAAAA,UAAU,EAAEb,SANJ;AAORc,MAAAA,eAAe,EAAEb;AAPT,KAAV;AASD;;AACD,SAAOC,OAAP;AACD,CAnCM;;IAqCDa,U;;;;;AACJ,wBAAc;AAAA;;AAAA,6BACN,eADM,EACW;AAAEC,MAAAA,aAAa,EAAE;AAAjB,KADX;AAEb;;;;WAED,uBAUG;AAAA,UATDC,cASC,SATDA,cASC;AAAA,UARDvB,OAQC,SARDA,OAQC;AAAA,UAPQC,SAOR,SAPDc,OAOC;AAAA,UANDb,iBAMC,SANDA,iBAMC;AAAA,UALQC,MAKR,SALDa,OAKC;AAAA,UAJDZ,KAIC,SAJDA,KAIC;AAAA,iCAHDC,QAGC;AAAA,UAHDA,QAGC,+BAHU,EAGV;AAAA,kCAFDC,SAEC;AAAA,UAFDA,SAEC,gCAFW,EAEX;AAAA,UADDC,cACC,SADDA,cACC;AACD,aAAOiB,KAAK,CAAC;AACXC,QAAAA,MAAM,EAAE,MADG;AAEXC,QAAAA,GAAG,YAAK,KAAKA,GAAV,cAAiBH,cAAjB,cAFQ;AAGXI,QAAAA,IAAI,EAAE5B,kBAAkB,CAAC;AACvBC,UAAAA,OAAO,EAAPA,OADuB;AAEvBC,UAAAA,SAAS,EAATA,SAFuB;AAGvBC,UAAAA,iBAAiB,EAAjBA,iBAHuB;AAIvBC,UAAAA,MAAM,EAANA,MAJuB;AAKvBC,UAAAA,KAAK,EAALA,KALuB;AAMvBC,UAAAA,QAAQ,EAARA,QANuB;AAOvBC,UAAAA,SAAS,EAATA,SAPuB;AAQvBC,UAAAA,cAAc,EAAdA;AARuB,SAAD;AAHb,OAAD,CAAZ;AAcD;;;WAED,iBAAOqB,cAAP,EAAuBC,SAAvB,EAAkC;AAChC,aAAOL,KAAK,CAACM,MAAN,WAAgB,KAAKJ,GAArB,cAA4BE,cAA5B,uBAAuDC,SAAvD,EAAP;AACD;;;WAED,oCAAgD;AAAA,UAA1BN,cAA0B,SAA1BA,cAA0B;AAAA,UAAVQ,MAAU,SAAVA,MAAU;AAC9C,aAAOP,KAAK,CAACQ,GAAN,WAAa,KAAKN,GAAlB,cAAyBH,cAAzB,gBAAoD;AACzDU,QAAAA,MAAM,EAAE;AAAEF,UAAAA,MAAM,EAANA;AAAF;AADiD,OAApD,CAAP;AAGD;;;;EAxCsBjC,S;;AA2CzB,eAAe,IAAIuB,UAAJ,EAAf","sourcesContent":["/* eslint no-console: 0 */\n/* global axios */\nimport ApiClient from '../ApiClient';\n\nexport const buildCreatePayload = ({\n  message,\n  isPrivate,\n  contentAttributes,\n  echoId,\n  files,\n  ccEmails = '',\n  bccEmails = '',\n  templateParams,\n}) => {\n  let payload;\n  if (files && files.length !== 0) {\n    payload = new FormData();\n    if (message) {\n      payload.append('content', message);\n    }\n    files.forEach(file => {\n      payload.append('attachments[]', file);\n    });\n    payload.append('private', isPrivate);\n    payload.append('echo_id', echoId);\n    payload.append('cc_emails', ccEmails);\n    payload.append('bcc_emails', bccEmails);\n  } else {\n    payload = {\n      content: message,\n      private: isPrivate,\n      echo_id: echoId,\n      content_attributes: contentAttributes,\n      cc_emails: ccEmails,\n      bcc_emails: bccEmails,\n      template_params: templateParams,\n    };\n  }\n  return payload;\n};\n\nclass MessageApi extends ApiClient {\n  constructor() {\n    super('conversations', { accountScoped: true });\n  }\n\n  create({\n    conversationId,\n    message,\n    private: isPrivate,\n    contentAttributes,\n    echo_id: echoId,\n    files,\n    ccEmails = '',\n    bccEmails = '',\n    templateParams,\n  }) {\n    return axios({\n      method: 'post',\n      url: `${this.url}/${conversationId}/messages`,\n      data: buildCreatePayload({\n        message,\n        isPrivate,\n        contentAttributes,\n        echoId,\n        files,\n        ccEmails,\n        bccEmails,\n        templateParams,\n      }),\n    });\n  }\n\n  delete(conversationID, messageId) {\n    return axios.delete(`${this.url}/${conversationID}/messages/${messageId}`);\n  }\n\n  getPreviousMessages({ conversationId, before }) {\n    return axios.get(`${this.url}/${conversationId}/messages`, {\n      params: { before },\n    });\n  }\n}\n\nexport default new MessageApi();\n"]},"metadata":{},"sourceType":"module"}