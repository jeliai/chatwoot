{"ast":null,"code":"import fromUnixTime from 'date-fns/fromUnixTime';\nimport differenceInDays from 'date-fns/differenceInDays';\nimport Cookies from 'js-cookie';\nimport { ANALYTICS_IDENTITY, ANALYTICS_RESET, CHATWOOT_RESET, CHATWOOT_SET_USER } from '../../helper/scriptHelpers';\nimport { LocalStorage, LOCAL_STORAGE_KEYS } from '../../helper/localStorage';\nCookies.defaults = {\n  sameSite: 'Lax'\n};\nexport var getLoadingStatus = function getLoadingStatus(state) {\n  return state.fetchAPIloadingStatus;\n};\nexport var setLoadingStatus = function setLoadingStatus(state, status) {\n  state.fetchAPIloadingStatus = status;\n};\nexport var setUser = function setUser(user) {\n  window.bus.$emit(CHATWOOT_SET_USER, {\n    user: user\n  });\n  window.bus.$emit(ANALYTICS_IDENTITY, {\n    user: user\n  });\n};\nexport var getHeaderExpiry = function getHeaderExpiry(response) {\n  return fromUnixTime(response.headers.expiry);\n};\nexport var setAuthCredentials = function setAuthCredentials(response) {\n  var expiryDate = getHeaderExpiry(response);\n  Cookies.set('cw_d_session_info', response.headers, {\n    expires: differenceInDays(expiryDate, new Date())\n  });\n  setUser(response.data.data, expiryDate);\n};\nexport var clearBrowserSessionCookies = function clearBrowserSessionCookies() {\n  Cookies.remove('cw_d_session_info');\n  Cookies.remove('auth_data');\n  Cookies.remove('user');\n};\nexport var clearLocalStorageOnLogout = function clearLocalStorageOnLogout() {\n  LocalStorage.remove(LOCAL_STORAGE_KEYS.DRAFT_MESSAGES);\n};\nexport var clearCookiesOnLogout = function clearCookiesOnLogout() {\n  window.bus.$emit(CHATWOOT_RESET);\n  window.bus.$emit(ANALYTICS_RESET);\n  clearBrowserSessionCookies();\n  clearLocalStorageOnLogout();\n  var globalConfig = window.globalConfig || {};\n  var logoutRedirectLink = globalConfig.LOGOUT_REDIRECT_LINK || '/';\n  window.location = logoutRedirectLink;\n};\nexport var parseAPIErrorResponse = function parseAPIErrorResponse(error) {\n  var _error$response, _error$response$data, _error$response3, _error$response3$data;\n\n  if (error !== null && error !== void 0 && (_error$response = error.response) !== null && _error$response !== void 0 && (_error$response$data = _error$response.data) !== null && _error$response$data !== void 0 && _error$response$data.message) {\n    var _error$response2, _error$response2$data;\n\n    return error === null || error === void 0 ? void 0 : (_error$response2 = error.response) === null || _error$response2 === void 0 ? void 0 : (_error$response2$data = _error$response2.data) === null || _error$response2$data === void 0 ? void 0 : _error$response2$data.message;\n  }\n\n  if (error !== null && error !== void 0 && (_error$response3 = error.response) !== null && _error$response3 !== void 0 && (_error$response3$data = _error$response3.data) !== null && _error$response3$data !== void 0 && _error$response3$data.error) {\n    var _error$response4, _error$response4$data;\n\n    return error === null || error === void 0 ? void 0 : (_error$response4 = error.response) === null || _error$response4 === void 0 ? void 0 : (_error$response4$data = _error$response4.data) === null || _error$response4$data === void 0 ? void 0 : _error$response4$data.error;\n  }\n\n  return error;\n};\nexport var throwErrorMessage = function throwErrorMessage(error) {\n  var errorMessage = parseAPIErrorResponse(error);\n  throw new Error(errorMessage);\n};","map":{"version":3,"sources":["/Users/s.dastan/Desktop/chatwoot/chatwoot/app/javascript/dashboard/store/utils/api.js"],"names":["fromUnixTime","differenceInDays","Cookies","ANALYTICS_IDENTITY","ANALYTICS_RESET","CHATWOOT_RESET","CHATWOOT_SET_USER","LocalStorage","LOCAL_STORAGE_KEYS","defaults","sameSite","getLoadingStatus","state","fetchAPIloadingStatus","setLoadingStatus","status","setUser","user","window","bus","$emit","getHeaderExpiry","response","headers","expiry","setAuthCredentials","expiryDate","set","expires","Date","data","clearBrowserSessionCookies","remove","clearLocalStorageOnLogout","DRAFT_MESSAGES","clearCookiesOnLogout","globalConfig","logoutRedirectLink","LOGOUT_REDIRECT_LINK","location","parseAPIErrorResponse","error","message","throwErrorMessage","errorMessage","Error"],"mappings":"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","sourcesContent":["import fromUnixTime from 'date-fns/fromUnixTime';\nimport differenceInDays from 'date-fns/differenceInDays';\nimport Cookies from 'js-cookie';\nimport {\n  ANALYTICS_IDENTITY,\n  ANALYTICS_RESET,\n  CHATWOOT_RESET,\n  CHATWOOT_SET_USER,\n} from '../../helper/scriptHelpers';\nimport { LocalStorage, LOCAL_STORAGE_KEYS } from '../../helper/localStorage';\n\nCookies.defaults = { sameSite: 'Lax' };\n\nexport const getLoadingStatus = state => state.fetchAPIloadingStatus;\nexport const setLoadingStatus = (state, status) => {\n  state.fetchAPIloadingStatus = status;\n};\n\nexport const setUser = user => {\n  window.bus.$emit(CHATWOOT_SET_USER, { user });\n  window.bus.$emit(ANALYTICS_IDENTITY, { user });\n};\n\nexport const getHeaderExpiry = response =>\n  fromUnixTime(response.headers.expiry);\n\nexport const setAuthCredentials = response => {\n  const expiryDate = getHeaderExpiry(response);\n  Cookies.set('cw_d_session_info', response.headers, {\n    expires: differenceInDays(expiryDate, new Date()),\n  });\n  setUser(response.data.data, expiryDate);\n};\n\nexport const clearBrowserSessionCookies = () => {\n  Cookies.remove('cw_d_session_info');\n  Cookies.remove('auth_data');\n  Cookies.remove('user');\n};\n\nexport const clearLocalStorageOnLogout = () => {\n  LocalStorage.remove(LOCAL_STORAGE_KEYS.DRAFT_MESSAGES);\n};\n\nexport const clearCookiesOnLogout = () => {\n  window.bus.$emit(CHATWOOT_RESET);\n  window.bus.$emit(ANALYTICS_RESET);\n  clearBrowserSessionCookies();\n  clearLocalStorageOnLogout();\n  const globalConfig = window.globalConfig || {};\n  const logoutRedirectLink = globalConfig.LOGOUT_REDIRECT_LINK || '/';\n  window.location = logoutRedirectLink;\n};\n\nexport const parseAPIErrorResponse = error => {\n  if (error?.response?.data?.message) {\n    return error?.response?.data?.message;\n  }\n  if (error?.response?.data?.error) {\n    return error?.response?.data?.error;\n  }\n  return error;\n};\n\nexport const throwErrorMessage = error => {\n  const errorMessage = parseAPIErrorResponse(error);\n  throw new Error(errorMessage);\n};\n"]},"metadata":{},"sourceType":"module"}