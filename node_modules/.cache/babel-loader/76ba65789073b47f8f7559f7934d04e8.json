{"ast":null,"code":"import \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.array.includes.js\";\nimport \"core-js/modules/es.string.includes.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport Modal from 'dashboard/components/Modal';\nimport alertMixin from 'shared/mixins/alertMixin';\nimport { required } from 'vuelidate/lib/validators';\nimport allLocales from 'shared/constants/locales.js';\nexport default {\n  components: {\n    Modal: Modal\n  },\n  mixins: [alertMixin],\n  props: {\n    show: {\n      type: Boolean,\n      default: true\n    },\n    portal: {\n      type: Object,\n      default: function _default() {\n        return {};\n      }\n    }\n  },\n  data: function data() {\n    return {\n      selectedLocale: '',\n      isUpdating: false\n    };\n  },\n  computed: {\n    addedLocales: function addedLocales() {\n      var allowedLocales = this.portal.config.allowed_locales;\n      return allowedLocales.map(function (locale) {\n        return locale.code;\n      });\n    },\n    locales: function locales() {\n      var addedLocales = this.portal.config.allowed_locales.map(function (locale) {\n        return locale.code;\n      });\n      return Object.keys(allLocales).map(function (key) {\n        return {\n          id: key,\n          name: allLocales[key],\n          code: key\n        };\n      }).filter(function (locale) {\n        return !addedLocales.includes(locale.code);\n      });\n    }\n  },\n  validations: {\n    selectedLocale: {\n      required: required\n    }\n  },\n  methods: {\n    onCreate: function onCreate() {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        var updatedLocales;\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _this.$v.$touch();\n\n                if (!_this.$v.$invalid) {\n                  _context.next = 3;\n                  break;\n                }\n\n                return _context.abrupt(\"return\");\n\n              case 3:\n                updatedLocales = _this.addedLocales;\n                updatedLocales.push(_this.selectedLocale);\n                _this.isUpdating = true;\n                _context.prev = 6;\n                _context.next = 9;\n                return _this.$store.dispatch('portals/update', {\n                  portalSlug: _this.portal.slug,\n                  config: {\n                    allowed_locales: updatedLocales\n                  }\n                });\n\n              case 9:\n                _this.alertMessage = _this.$t('HELP_CENTER.PORTAL.ADD_LOCALE.API.SUCCESS_MESSAGE');\n\n                _this.onClose();\n\n                _context.next = 16;\n                break;\n\n              case 13:\n                _context.prev = 13;\n                _context.t0 = _context[\"catch\"](6);\n                _this.alertMessage = (_context.t0 === null || _context.t0 === void 0 ? void 0 : _context.t0.message) || _this.$t('HELP_CENTER.PORTAL.ADD_LOCALE.API.ERROR_MESSAGE');\n\n              case 16:\n                _context.prev = 16;\n\n                _this.showAlert(_this.alertMessage);\n\n                _this.isUpdating = false;\n                return _context.finish(16);\n\n              case 20:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[6, 13, 16, 20]]);\n      }))();\n    },\n    onClose: function onClose() {\n      this.$emit('cancel');\n    }\n  }\n};","map":{"version":3,"sources":["AddLocale.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAwCA,OAAA,KAAA,MAAA,4BAAA;AACA,OAAA,UAAA,MAAA,0BAAA;AACA,SAAA,QAAA,QAAA,0BAAA;AACA,OAAA,UAAA,MAAA,6BAAA;AACA,eAAA;AACA,EAAA,UAAA,EAAA;AACA,IAAA,KAAA,EAAA;AADA,GADA;AAIA,EAAA,MAAA,EAAA,CAAA,UAAA,CAJA;AAKA,EAAA,KAAA,EAAA;AACA,IAAA,IAAA,EAAA;AACA,MAAA,IAAA,EAAA,OADA;AAEA,MAAA,OAAA,EAAA;AAFA,KADA;AAKA,IAAA,MAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,OAAA,EAAA;AAAA,eAAA,EAAA;AAAA;AAFA;AALA,GALA;AAeA,EAAA,IAfA,kBAeA;AACA,WAAA;AACA,MAAA,cAAA,EAAA,EADA;AAEA,MAAA,UAAA,EAAA;AAFA,KAAA;AAIA,GApBA;AAqBA,EAAA,QAAA,EAAA;AACA,IAAA,YADA,0BACA;AACA,UAAA,cAAA,GAAA,KAAA,MAAA,CAAA,MAAA,CAAA,eAAA;AACA,aAAA,cAAA,CAAA,GAAA,CAAA,UAAA,MAAA;AAAA,eAAA,MAAA,CAAA,IAAA;AAAA,OAAA,CAAA;AACA,KAJA;AAKA,IAAA,OALA,qBAKA;AACA,UAAA,YAAA,GAAA,KAAA,MAAA,CAAA,MAAA,CAAA,eAAA,CAAA,GAAA,CACA,UAAA,MAAA;AAAA,eAAA,MAAA,CAAA,IAAA;AAAA,OADA,CAAA;AAGA,aAAA,MAAA,CAAA,IAAA,CAAA,UAAA,EACA,GADA,CACA,UAAA,GAAA,EAAA;AACA,eAAA;AACA,UAAA,EAAA,EAAA,GADA;AAEA,UAAA,IAAA,EAAA,UAAA,CAAA,GAAA,CAFA;AAGA,UAAA,IAAA,EAAA;AAHA,SAAA;AAKA,OAPA,EAQA,MARA,CAQA,UAAA,MAAA,EAAA;AACA,eAAA,CAAA,YAAA,CAAA,QAAA,CAAA,MAAA,CAAA,IAAA,CAAA;AACA,OAVA,CAAA;AAWA;AApBA,GArBA;AA2CA,EAAA,WAAA,EAAA;AACA,IAAA,cAAA,EAAA;AACA,MAAA,QAAA,EAAA;AADA;AADA,GA3CA;AAgDA,EAAA,OAAA,EAAA;AACA,IAAA,QADA,sBACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA,gBAAA,KAAA,CAAA,EAAA,CAAA,MAAA;;AADA,qBAEA,KAAA,CAAA,EAAA,CAAA,QAFA;AAAA;AAAA;AAAA;;AAAA;;AAAA;AAKA,gBAAA,cALA,GAKA,KAAA,CAAA,YALA;AAMA,gBAAA,cAAA,CAAA,IAAA,CAAA,KAAA,CAAA,cAAA;AACA,gBAAA,KAAA,CAAA,UAAA,GAAA,IAAA;AAPA;AAAA;AAAA,uBASA,KAAA,CAAA,MAAA,CAAA,QAAA,CAAA,gBAAA,EAAA;AACA,kBAAA,UAAA,EAAA,KAAA,CAAA,MAAA,CAAA,IADA;AAEA,kBAAA,MAAA,EAAA;AAAA,oBAAA,eAAA,EAAA;AAAA;AAFA,iBAAA,CATA;;AAAA;AAaA,gBAAA,KAAA,CAAA,YAAA,GAAA,KAAA,CAAA,EAAA,CACA,mDADA,CAAA;;AAGA,gBAAA,KAAA,CAAA,OAAA;;AAhBA;AAAA;;AAAA;AAAA;AAAA;AAkBA,gBAAA,KAAA,CAAA,YAAA,GACA,uEAAA,OAAA,KACA,KAAA,CAAA,EAAA,CAAA,iDAAA,CAFA;;AAlBA;AAAA;;AAsBA,gBAAA,KAAA,CAAA,SAAA,CAAA,KAAA,CAAA,YAAA;;AACA,gBAAA,KAAA,CAAA,UAAA,GAAA,KAAA;AAvBA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAyBA,KA1BA;AA2BA,IAAA,OA3BA,qBA2BA;AACA,WAAA,KAAA,CAAA,QAAA;AACA;AA7BA;AAhDA,CAAA","sourcesContent":["<template>\n  <modal :show.sync=\"show\" :on-close=\"onClose\">\n    <woot-modal-header\n      :header-title=\"$t('HELP_CENTER.PORTAL.ADD_LOCALE.TITLE')\"\n      :header-content=\"$t('HELP_CENTER.PORTAL.ADD_LOCALE.SUB_TITLE')\"\n    />\n    <form class=\"row\" @submit.prevent=\"onCreate\">\n      <div class=\"medium-12 columns\">\n        <label :class=\"{ error: $v.selectedLocale.$error }\">\n          {{ $t('HELP_CENTER.PORTAL.ADD_LOCALE.LOCALE.LABEL') }}\n          <select v-model=\"selectedLocale\">\n            <option\n              v-for=\"locale in locales\"\n              :key=\"locale.name\"\n              :value=\"locale.id\"\n            >\n              {{ locale.name }}-{{ locale.code }}\n            </option>\n          </select>\n          <span v-if=\"$v.selectedLocale.$error\" class=\"message\">\n            {{ $t('HELP_CENTER.PORTAL.ADD_LOCALE.LOCALE.ERROR') }}\n          </span>\n        </label>\n\n        <div class=\"medium-12 columns\">\n          <div class=\"modal-footer justify-content-end w-full\">\n            <woot-button class=\"button clear\" @click.prevent=\"onClose\">\n              {{ $t('HELP_CENTER.PORTAL.ADD_LOCALE.BUTTONS.CANCEL') }}\n            </woot-button>\n            <woot-button>\n              {{ $t('HELP_CENTER.PORTAL.ADD_LOCALE.BUTTONS.CREATE') }}\n            </woot-button>\n          </div>\n        </div>\n      </div>\n    </form>\n  </modal>\n</template>\n\n<script>\nimport Modal from 'dashboard/components/Modal';\nimport alertMixin from 'shared/mixins/alertMixin';\nimport { required } from 'vuelidate/lib/validators';\nimport allLocales from 'shared/constants/locales.js';\nexport default {\n  components: {\n    Modal,\n  },\n  mixins: [alertMixin],\n  props: {\n    show: {\n      type: Boolean,\n      default: true,\n    },\n    portal: {\n      type: Object,\n      default: () => ({}),\n    },\n  },\n  data() {\n    return {\n      selectedLocale: '',\n      isUpdating: false,\n    };\n  },\n  computed: {\n    addedLocales() {\n      const { allowed_locales: allowedLocales } = this.portal.config;\n      return allowedLocales.map(locale => locale.code);\n    },\n    locales() {\n      const addedLocales = this.portal.config.allowed_locales.map(\n        locale => locale.code\n      );\n      return Object.keys(allLocales)\n        .map(key => {\n          return {\n            id: key,\n            name: allLocales[key],\n            code: key,\n          };\n        })\n        .filter(locale => {\n          return !addedLocales.includes(locale.code);\n        });\n    },\n  },\n  validations: {\n    selectedLocale: {\n      required,\n    },\n  },\n  methods: {\n    async onCreate() {\n      this.$v.$touch();\n      if (this.$v.$invalid) {\n        return;\n      }\n      const updatedLocales = this.addedLocales;\n      updatedLocales.push(this.selectedLocale);\n      this.isUpdating = true;\n      try {\n        await this.$store.dispatch('portals/update', {\n          portalSlug: this.portal.slug,\n          config: { allowed_locales: updatedLocales },\n        });\n        this.alertMessage = this.$t(\n          'HELP_CENTER.PORTAL.ADD_LOCALE.API.SUCCESS_MESSAGE'\n        );\n        this.onClose();\n      } catch (error) {\n        this.alertMessage =\n          error?.message ||\n          this.$t('HELP_CENTER.PORTAL.ADD_LOCALE.API.ERROR_MESSAGE');\n      } finally {\n        this.showAlert(this.alertMessage);\n        this.isUpdating = false;\n      }\n    },\n    onClose() {\n      this.$emit('cancel');\n    },\n  },\n};\n</script>\n<style scoped lang=\"scss\">\n.input-container::v-deep {\n  margin: 0 0 var(--space-normal);\n\n  input {\n    margin-bottom: 0;\n  }\n  .message {\n    margin-top: 0;\n  }\n}\n</style>\n"],"sourceRoot":"app/javascript/dashboard/routes/dashboard/helpcenter/components"},"metadata":{},"sourceType":"module"}