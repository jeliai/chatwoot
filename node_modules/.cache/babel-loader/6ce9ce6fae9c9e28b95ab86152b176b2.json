{"ast":null,"code":"var _mutations;\n\nfunction _toConsumableArray(arr) { return _arrayWithoutHoles(arr) || _iterableToArray(arr) || _unsupportedIterableToArray(arr) || _nonIterableSpread(); }\n\nfunction _nonIterableSpread() { throw new TypeError(\"Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _iterableToArray(iter) { if (typeof Symbol !== \"undefined\" && iter[Symbol.iterator] != null || iter[\"@@iterator\"] != null) return Array.from(iter); }\n\nfunction _arrayWithoutHoles(arr) { if (Array.isArray(arr)) return _arrayLikeToArray(arr); }\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nfunction _slicedToArray(arr, i) { return _arrayWithHoles(arr) || _iterableToArrayLimit(arr, i) || _unsupportedIterableToArray(arr, i) || _nonIterableRest(); }\n\nfunction _nonIterableRest() { throw new TypeError(\"Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.\"); }\n\nfunction _unsupportedIterableToArray(o, minLen) { if (!o) return; if (typeof o === \"string\") return _arrayLikeToArray(o, minLen); var n = Object.prototype.toString.call(o).slice(8, -1); if (n === \"Object\" && o.constructor) n = o.constructor.name; if (n === \"Map\" || n === \"Set\") return Array.from(o); if (n === \"Arguments\" || /^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)) return _arrayLikeToArray(o, minLen); }\n\nfunction _arrayLikeToArray(arr, len) { if (len == null || len > arr.length) len = arr.length; for (var i = 0, arr2 = new Array(len); i < len; i++) { arr2[i] = arr[i]; } return arr2; }\n\nfunction _iterableToArrayLimit(arr, i) { var _i = arr && (typeof Symbol !== \"undefined\" && arr[Symbol.iterator] || arr[\"@@iterator\"]); if (_i == null) return; var _arr = []; var _n = true; var _d = false; var _s, _e; try { for (_i = _i.call(arr); !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"] != null) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; }\n\nfunction _arrayWithHoles(arr) { if (Array.isArray(arr)) return arr; }\n\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.symbol.description.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.symbol.iterator.js\";\nimport \"core-js/modules/es.array.iterator.js\";\nimport \"core-js/modules/es.string.iterator.js\";\nimport \"core-js/modules/web.dom-collections.iterator.js\";\nimport \"core-js/modules/es.array.slice.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.from.js\";\nimport \"core-js/modules/es.promise.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptors.js\";\n\n/* eslint no-param-reassign: 0 */\nimport Vue from 'vue';\nimport * as MutationHelpers from 'shared/helpers/vuex/mutationHelpers';\nimport * as types from '../mutation-types';\nimport IntegrationsAPI from '../../api/integrations';\nvar state = {\n  records: [],\n  uiFlags: {\n    isCreating: false,\n    isFetching: false,\n    isFetchingItem: false,\n    isUpdating: false,\n    isCreatingHook: false,\n    isDeletingHook: false\n  }\n};\nexport var getters = {\n  getIntegrations: function getIntegrations($state) {\n    return $state.records.filter(function (item) {\n      return item.id !== 'fullcontact' && item.id !== 'dialogflow';\n    });\n  },\n  getAppIntegrations: function getAppIntegrations($state) {\n    return $state.records.filter(function (item) {\n      return item.id === 'dialogflow';\n    });\n  },\n  getIntegration: function getIntegration($state) {\n    return function (integrationId) {\n      var _$state$records$filte = $state.records.filter(function (record) {\n        return record.id === integrationId;\n      }),\n          _$state$records$filte2 = _slicedToArray(_$state$records$filte, 1),\n          integration = _$state$records$filte2[0];\n\n      return integration || {};\n    };\n  },\n  getUIFlags: function getUIFlags($state) {\n    return $state.uiFlags;\n  }\n};\nexport var actions = {\n  get: function () {\n    var _get = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee(_ref) {\n      var commit, response;\n      return regeneratorRuntime.wrap(function _callee$(_context) {\n        while (1) {\n          switch (_context.prev = _context.next) {\n            case 0:\n              commit = _ref.commit;\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isFetching: true\n              });\n              _context.prev = 2;\n              _context.next = 5;\n              return IntegrationsAPI.get();\n\n            case 5:\n              response = _context.sent;\n              commit(types.default.SET_INTEGRATIONS, response.data.payload);\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isFetching: false\n              });\n              _context.next = 13;\n              break;\n\n            case 10:\n              _context.prev = 10;\n              _context.t0 = _context[\"catch\"](2);\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isFetching: false\n              });\n\n            case 13:\n            case \"end\":\n              return _context.stop();\n          }\n        }\n      }, _callee, null, [[2, 10]]);\n    }));\n\n    function get(_x) {\n      return _get.apply(this, arguments);\n    }\n\n    return get;\n  }(),\n  connectSlack: function () {\n    var _connectSlack = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2(_ref2, code) {\n      var commit, response;\n      return regeneratorRuntime.wrap(function _callee2$(_context2) {\n        while (1) {\n          switch (_context2.prev = _context2.next) {\n            case 0:\n              commit = _ref2.commit;\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isUpdating: true\n              });\n              _context2.prev = 2;\n              _context2.next = 5;\n              return IntegrationsAPI.connectSlack(code);\n\n            case 5:\n              response = _context2.sent;\n              commit(types.default.ADD_INTEGRATION, response.data);\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isUpdating: false\n              });\n              _context2.next = 13;\n              break;\n\n            case 10:\n              _context2.prev = 10;\n              _context2.t0 = _context2[\"catch\"](2);\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isUpdating: false\n              });\n\n            case 13:\n            case \"end\":\n              return _context2.stop();\n          }\n        }\n      }, _callee2, null, [[2, 10]]);\n    }));\n\n    function connectSlack(_x2, _x3) {\n      return _connectSlack.apply(this, arguments);\n    }\n\n    return connectSlack;\n  }(),\n  deleteIntegration: function () {\n    var _deleteIntegration = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee3(_ref3, integrationId) {\n      var commit;\n      return regeneratorRuntime.wrap(function _callee3$(_context3) {\n        while (1) {\n          switch (_context3.prev = _context3.next) {\n            case 0:\n              commit = _ref3.commit;\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isDeleting: true\n              });\n              _context3.prev = 2;\n              _context3.next = 5;\n              return IntegrationsAPI.delete(integrationId);\n\n            case 5:\n              commit(types.default.DELETE_INTEGRATION, {\n                id: integrationId,\n                enabled: false\n              });\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isDeleting: false\n              });\n              _context3.next = 12;\n              break;\n\n            case 9:\n              _context3.prev = 9;\n              _context3.t0 = _context3[\"catch\"](2);\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isDeleting: false\n              });\n\n            case 12:\n            case \"end\":\n              return _context3.stop();\n          }\n        }\n      }, _callee3, null, [[2, 9]]);\n    }));\n\n    function deleteIntegration(_x4, _x5) {\n      return _deleteIntegration.apply(this, arguments);\n    }\n\n    return deleteIntegration;\n  }(),\n  createHook: function () {\n    var _createHook = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee4(_ref4, hookData) {\n      var commit, response;\n      return regeneratorRuntime.wrap(function _callee4$(_context4) {\n        while (1) {\n          switch (_context4.prev = _context4.next) {\n            case 0:\n              commit = _ref4.commit;\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isCreatingHook: true\n              });\n              _context4.prev = 2;\n              _context4.next = 5;\n              return IntegrationsAPI.createHook(hookData);\n\n            case 5:\n              response = _context4.sent;\n              commit(types.default.ADD_INTEGRATION_HOOKS, response.data);\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isCreatingHook: false\n              });\n              _context4.next = 14;\n              break;\n\n            case 10:\n              _context4.prev = 10;\n              _context4.t0 = _context4[\"catch\"](2);\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isCreatingHook: false\n              });\n              throw new Error(_context4.t0);\n\n            case 14:\n            case \"end\":\n              return _context4.stop();\n          }\n        }\n      }, _callee4, null, [[2, 10]]);\n    }));\n\n    function createHook(_x6, _x7) {\n      return _createHook.apply(this, arguments);\n    }\n\n    return createHook;\n  }(),\n  deleteHook: function () {\n    var _deleteHook = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee5(_ref5, _ref6) {\n      var commit, appId, hookId;\n      return regeneratorRuntime.wrap(function _callee5$(_context5) {\n        while (1) {\n          switch (_context5.prev = _context5.next) {\n            case 0:\n              commit = _ref5.commit;\n              appId = _ref6.appId, hookId = _ref6.hookId;\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isDeletingHook: true\n              });\n              _context5.prev = 3;\n              _context5.next = 6;\n              return IntegrationsAPI.deleteHook(hookId);\n\n            case 6:\n              commit(types.default.DELETE_INTEGRATION_HOOKS, {\n                appId: appId,\n                hookId: hookId\n              });\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isDeletingHook: false\n              });\n              _context5.next = 14;\n              break;\n\n            case 10:\n              _context5.prev = 10;\n              _context5.t0 = _context5[\"catch\"](3);\n              commit(types.default.SET_INTEGRATIONS_UI_FLAG, {\n                isDeletingHook: false\n              });\n              throw new Error(_context5.t0);\n\n            case 14:\n            case \"end\":\n              return _context5.stop();\n          }\n        }\n      }, _callee5, null, [[3, 10]]);\n    }));\n\n    function deleteHook(_x8, _x9) {\n      return _deleteHook.apply(this, arguments);\n    }\n\n    return deleteHook;\n  }()\n};\nexport var mutations = (_mutations = {}, _defineProperty(_mutations, types.default.SET_INTEGRATIONS_UI_FLAG, function ($state, uiFlag) {\n  $state.uiFlags = _objectSpread(_objectSpread({}, $state.uiFlags), uiFlag);\n}), _defineProperty(_mutations, types.default.SET_INTEGRATIONS, MutationHelpers.set), _defineProperty(_mutations, types.default.ADD_INTEGRATION, MutationHelpers.updateAttributes), _defineProperty(_mutations, types.default.DELETE_INTEGRATION, MutationHelpers.updateAttributes), _defineProperty(_mutations, types.default.ADD_INTEGRATION_HOOKS, function ($state, data) {\n  $state.records.forEach(function (element, index) {\n    if (element.id === data.app_id) {\n      var record = $state.records[index];\n      Vue.set(record, 'hooks', [].concat(_toConsumableArray(record.hooks), [data]));\n    }\n  });\n}), _defineProperty(_mutations, types.default.DELETE_INTEGRATION_HOOKS, function ($state, _ref7) {\n  var appId = _ref7.appId,\n      hookId = _ref7.hookId;\n  $state.records.forEach(function (element, index) {\n    if (element.id === appId) {\n      var record = $state.records[index];\n      var hooksWithoutDeletedHook = record.hooks.filter(function (hook) {\n        return hook.id !== hookId;\n      });\n      Vue.set(record, 'hooks', hooksWithoutDeletedHook);\n    }\n  });\n}), _mutations);\nexport default {\n  namespaced: true,\n  state: state,\n  getters: getters,\n  actions: actions,\n  mutations: mutations\n};","map":{"version":3,"sources":["/Users/s.dastan/Desktop/chatwoot/chatwoot/app/javascript/dashboard/store/modules/integrations.js"],"names":["Vue","MutationHelpers","types","IntegrationsAPI","state","records","uiFlags","isCreating","isFetching","isFetchingItem","isUpdating","isCreatingHook","isDeletingHook","getters","getIntegrations","$state","filter","item","id","getAppIntegrations","getIntegration","integrationId","record","integration","getUIFlags","actions","get","commit","default","SET_INTEGRATIONS_UI_FLAG","response","SET_INTEGRATIONS","data","payload","connectSlack","code","ADD_INTEGRATION","deleteIntegration","isDeleting","delete","DELETE_INTEGRATION","enabled","createHook","hookData","ADD_INTEGRATION_HOOKS","Error","deleteHook","appId","hookId","DELETE_INTEGRATION_HOOKS","mutations","uiFlag","set","updateAttributes","forEach","element","index","app_id","hooks","hooksWithoutDeletedHook","hook","namespaced"],"mappings":"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","sourcesContent":["/* eslint no-param-reassign: 0 */\nimport Vue from 'vue';\nimport * as MutationHelpers from 'shared/helpers/vuex/mutationHelpers';\nimport * as types from '../mutation-types';\nimport IntegrationsAPI from '../../api/integrations';\n\nconst state = {\n  records: [],\n  uiFlags: {\n    isCreating: false,\n    isFetching: false,\n    isFetchingItem: false,\n    isUpdating: false,\n    isCreatingHook: false,\n    isDeletingHook: false,\n  },\n};\n\nexport const getters = {\n  getIntegrations($state) {\n    return $state.records.filter(\n      item => item.id !== 'fullcontact' && item.id !== 'dialogflow'\n    );\n  },\n  getAppIntegrations($state) {\n    return $state.records.filter(item => item.id === 'dialogflow');\n  },\n  getIntegration: $state => integrationId => {\n    const [integration] = $state.records.filter(\n      record => record.id === integrationId\n    );\n    return integration || {};\n  },\n  getUIFlags($state) {\n    return $state.uiFlags;\n  },\n};\n\nexport const actions = {\n  get: async ({ commit }) => {\n    commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isFetching: true });\n    try {\n      const response = await IntegrationsAPI.get();\n      commit(types.default.SET_INTEGRATIONS, response.data.payload);\n      commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isFetching: false });\n    } catch (error) {\n      commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isFetching: false });\n    }\n  },\n\n  connectSlack: async ({ commit }, code) => {\n    commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isUpdating: true });\n    try {\n      const response = await IntegrationsAPI.connectSlack(code);\n      commit(types.default.ADD_INTEGRATION, response.data);\n      commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isUpdating: false });\n    } catch (error) {\n      commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isUpdating: false });\n    }\n  },\n\n  deleteIntegration: async ({ commit }, integrationId) => {\n    commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isDeleting: true });\n    try {\n      await IntegrationsAPI.delete(integrationId);\n      commit(types.default.DELETE_INTEGRATION, {\n        id: integrationId,\n        enabled: false,\n      });\n      commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isDeleting: false });\n    } catch (error) {\n      commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isDeleting: false });\n    }\n  },\n  createHook: async ({ commit }, hookData) => {\n    commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isCreatingHook: true });\n    try {\n      const response = await IntegrationsAPI.createHook(hookData);\n      commit(types.default.ADD_INTEGRATION_HOOKS, response.data);\n      commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isCreatingHook: false });\n    } catch (error) {\n      commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isCreatingHook: false });\n      throw new Error(error);\n    }\n  },\n  deleteHook: async ({ commit }, { appId, hookId }) => {\n    commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isDeletingHook: true });\n    try {\n      await IntegrationsAPI.deleteHook(hookId);\n      commit(types.default.DELETE_INTEGRATION_HOOKS, { appId, hookId });\n      commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isDeletingHook: false });\n    } catch (error) {\n      commit(types.default.SET_INTEGRATIONS_UI_FLAG, { isDeletingHook: false });\n      throw new Error(error);\n    }\n  },\n};\n\nexport const mutations = {\n  [types.default.SET_INTEGRATIONS_UI_FLAG]($state, uiFlag) {\n    $state.uiFlags = { ...$state.uiFlags, ...uiFlag };\n  },\n  [types.default.SET_INTEGRATIONS]: MutationHelpers.set,\n  [types.default.ADD_INTEGRATION]: MutationHelpers.updateAttributes,\n  [types.default.DELETE_INTEGRATION]: MutationHelpers.updateAttributes,\n  [types.default.ADD_INTEGRATION_HOOKS]: ($state, data) => {\n    $state.records.forEach((element, index) => {\n      if (element.id === data.app_id) {\n        const record = $state.records[index];\n        Vue.set(record, 'hooks', [...record.hooks, data]);\n      }\n    });\n  },\n  [types.default.DELETE_INTEGRATION_HOOKS]: ($state, { appId, hookId }) => {\n    $state.records.forEach((element, index) => {\n      if (element.id === appId) {\n        const record = $state.records[index];\n        const hooksWithoutDeletedHook = record.hooks.filter(\n          hook => hook.id !== hookId\n        );\n        Vue.set(record, 'hooks', hooksWithoutDeletedHook);\n      }\n    });\n  },\n};\n\nexport default {\n  namespaced: true,\n  state,\n  getters,\n  actions,\n  mutations,\n};\n"]},"metadata":{},"sourceType":"module"}