{"ast":null,"code":"import \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.map.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptors.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { mapGetters } from 'vuex';\nimport Widget from 'dashboard/modules/widget-preview/components/Widget';\nimport InputRadioGroup from './components/InputRadioGroup';\nimport alertMixin from 'shared/mixins/alertMixin';\nimport { required } from 'vuelidate/lib/validators';\nimport { LocalStorage, LOCAL_STORAGE_KEYS } from 'dashboard/helper/localStorage';\nexport default {\n  components: {\n    Widget: Widget,\n    InputRadioGroup: InputRadioGroup\n  },\n  mixins: [alertMixin],\n  props: {\n    inbox: {\n      type: Object,\n      default: function _default() {}\n    }\n  },\n  data: function data() {\n    return {\n      isWidgetPreview: true,\n      color: '#fc7658',\n      websiteName: '',\n      welcomeHeading: '',\n      welcomeTagline: '',\n      replyTime: 'in_a_few_minutes',\n      avatarFile: null,\n      avatarUrl: '',\n      widgetBubblePosition: 'right',\n      widgetBubbleLauncherTitle: this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_LAUNCHER_TITLE.DEFAULT'),\n      widgetBubbleType: 'standard',\n      widgetBubblePositions: [{\n        id: 'left',\n        title: this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_POSITION.LEFT'),\n        checked: false\n      }, {\n        id: 'right',\n        title: this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_POSITION.RIGHT'),\n        checked: true\n      }],\n      widgetBubbleTypes: [{\n        id: 'standard',\n        title: this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_TYPE.STANDARD'),\n        checked: true\n      }, {\n        id: 'expanded_bubble',\n        title: this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_TYPE.EXPANDED_BUBBLE'),\n        checked: false\n      }]\n    };\n  },\n  computed: _objectSpread(_objectSpread({}, mapGetters({\n    uiFlags: 'inboxes/getUIFlags'\n  })), {}, {\n    storageKey: function storageKey() {\n      return \"\".concat(LOCAL_STORAGE_KEYS.WIDGET_BUILDER).concat(this.inbox.id);\n    },\n    widgetScript: function widgetScript() {\n      var options = {\n        position: this.widgetBubblePosition,\n        type: this.widgetBubbleType,\n        launcherTitle: this.widgetBubbleLauncherTitle\n      };\n      var script = this.inbox.web_widget_script;\n      return script.substring(0, 13) + this.$t('INBOX_MGMT.WIDGET_BUILDER.SCRIPT_SETTINGS', {\n        options: JSON.stringify(options)\n      }) + script.substring(13);\n    },\n    getWidgetViewOptions: function getWidgetViewOptions() {\n      return [{\n        id: 'preview',\n        title: this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_VIEW_OPTION.PREVIEW'),\n        checked: true\n      }, {\n        id: 'script',\n        title: this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_VIEW_OPTION.SCRIPT'),\n        checked: false\n      }];\n    },\n    getReplyTimeOptions: function getReplyTimeOptions() {\n      return [{\n        key: 'in_a_few_minutes',\n        value: 'in_a_few_minutes',\n        text: this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.REPLY_TIME.IN_A_FEW_MINUTES')\n      }, {\n        key: 'in_a_few_hours',\n        value: 'in_a_few_hours',\n        text: this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.REPLY_TIME.IN_A_FEW_HOURS')\n      }, {\n        key: 'in_a_day',\n        value: 'in_a_day',\n        text: this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.REPLY_TIME.IN_A_DAY')\n      }];\n    },\n    websiteNameValidationErrorMsg: function websiteNameValidationErrorMsg() {\n      return this.$v.websiteName.$error ? this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WEBSITE_NAME.ERROR') : '';\n    }\n  }),\n  mounted: function mounted() {\n    this.setDefaults();\n  },\n  validations: {\n    websiteName: {\n      required: required\n    }\n  },\n  methods: {\n    setDefaults: function setDefaults() {\n      var _this = this;\n\n      // Widget Settings\n      var _this$inbox = this.inbox,\n          name = _this$inbox.name,\n          welcome_title = _this$inbox.welcome_title,\n          welcome_tagline = _this$inbox.welcome_tagline,\n          widget_color = _this$inbox.widget_color,\n          reply_time = _this$inbox.reply_time,\n          avatar_url = _this$inbox.avatar_url;\n      this.websiteName = name;\n      this.welcomeHeading = welcome_title;\n      this.welcomeTagline = welcome_tagline;\n      this.color = widget_color;\n      this.replyTime = reply_time;\n      this.avatarUrl = avatar_url;\n      var savedInformation = this.getSavedInboxInformation();\n\n      if (savedInformation) {\n        this.widgetBubblePositions = this.widgetBubblePositions.map(function (item) {\n          if (item.id === savedInformation.position) {\n            item.checked = true;\n            _this.widgetBubblePosition = item.id;\n          }\n\n          return item;\n        });\n        this.widgetBubbleTypes = this.widgetBubbleTypes.map(function (item) {\n          if (item.id === savedInformation.type) {\n            item.checked = true;\n            _this.widgetBubbleType = item.id;\n          }\n\n          return item;\n        });\n        this.widgetBubbleLauncherTitle = savedInformation.launcherTitle || 'Chat with us';\n      }\n    },\n    handleWidgetBubblePositionChange: function handleWidgetBubblePositionChange(item) {\n      this.widgetBubblePosition = item.id;\n    },\n    handleWidgetBubbleTypeChange: function handleWidgetBubbleTypeChange(item) {\n      this.widgetBubbleType = item.id;\n    },\n    handleWidgetViewChange: function handleWidgetViewChange(item) {\n      this.isWidgetPreview = item.id === 'preview';\n    },\n    handleImageUpload: function handleImageUpload(_ref) {\n      var file = _ref.file,\n          url = _ref.url;\n      this.avatarFile = file;\n      this.avatarUrl = url;\n    },\n    handleAvatarDelete: function handleAvatarDelete() {\n      var _this2 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return _this2.$store.dispatch('inboxes/deleteInboxAvatar', _this2.inbox.id);\n\n              case 3:\n                _this2.avatarFile = null;\n                _this2.avatarUrl = '';\n\n                _this2.showAlert(_this2.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.AVATAR.DELETE.API.SUCCESS_MESSAGE'));\n\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n\n                _this2.showAlert(_context.t0.message ? _context.t0.message : _this2.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.AVATAR.DELETE.API.ERROR_MESSAGE'));\n\n              case 11:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 8]]);\n      }))();\n    },\n    updateWidget: function updateWidget() {\n      var _this3 = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee2() {\n        var bubbleSettings, payload;\n        return regeneratorRuntime.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                bubbleSettings = {\n                  position: _this3.widgetBubblePosition,\n                  launcherTitle: _this3.widgetBubbleLauncherTitle,\n                  type: _this3.widgetBubbleType\n                };\n                LocalStorage.set(_this3.storageKey, bubbleSettings);\n                _context2.prev = 2;\n                payload = {\n                  id: _this3.inbox.id,\n                  name: _this3.websiteName,\n                  channel: {\n                    widget_color: _this3.color,\n                    welcome_title: _this3.welcomeHeading,\n                    welcome_tagline: _this3.welcomeTagline,\n                    reply_time: _this3.replyTime\n                  }\n                };\n\n                if (_this3.avatarFile) {\n                  payload.avatar = _this3.avatarFile;\n                }\n\n                _context2.next = 7;\n                return _this3.$store.dispatch('inboxes/updateInbox', payload);\n\n              case 7:\n                _this3.showAlert(_this3.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.UPDATE.API.SUCCESS_MESSAGE'));\n\n                _context2.next = 13;\n                break;\n\n              case 10:\n                _context2.prev = 10;\n                _context2.t0 = _context2[\"catch\"](2);\n\n                _this3.showAlert(_context2.t0.message || _this3.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.UPDATE.API.ERROR_MESSAGE'));\n\n              case 13:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, null, [[2, 10]]);\n      }))();\n    },\n    getSavedInboxInformation: function getSavedInboxInformation() {\n      return LocalStorage.get(this.storageKey);\n    }\n  }\n};","map":{"version":3,"sources":["WidgetBuilder.vue"],"names":[],"mappings":"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","sourcesContent":["<template>\n  <div class=\"settings--content\">\n    <div class=\"widget-builder-conatiner\">\n      <div class=\"settings-container\">\n        <div class=\"settings-content\">\n          <form @submit.prevent=\"updateWidget\">\n            <woot-avatar-uploader\n              :label=\"\n                $t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.AVATAR.LABEL')\n              \"\n              :src=\"avatarUrl\"\n              delete-avatar\n              @change=\"handleImageUpload\"\n              @onAvatarDelete=\"handleAvatarDelete\"\n            />\n            <woot-input\n              v-model.trim=\"websiteName\"\n              :class=\"{ error: $v.websiteName.$error }\"\n              :label=\"\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WEBSITE_NAME.LABEL'\n                )\n              \"\n              :placeholder=\"\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WEBSITE_NAME.PLACE_HOLDER'\n                )\n              \"\n              :error=\"websiteNameValidationErrorMsg\"\n              @blur=\"$v.websiteName.$touch\"\n            />\n            <woot-input\n              v-model.trim=\"welcomeHeading\"\n              :label=\"\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WELCOME_HEADING.LABEL'\n                )\n              \"\n              :placeholder=\"\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WELCOME_HEADING.PLACE_HOLDER'\n                )\n              \"\n            />\n            <woot-input\n              v-model.trim=\"welcomeTagline\"\n              :label=\"\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WELCOME_TAGLINE.LABEL'\n                )\n              \"\n              :placeholder=\"\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WELCOME_TAGLINE.PLACE_HOLDER'\n                )\n              \"\n            />\n            <label>\n              {{\n                $t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.REPLY_TIME.LABEL')\n              }}\n              <select v-model=\"replyTime\">\n                <option\n                  v-for=\"option in getReplyTimeOptions\"\n                  :key=\"option.key\"\n                  :value=\"option.value\"\n                >\n                  {{ option.text }}\n                </option>\n              </select>\n            </label>\n            <label>\n              {{\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_COLOR_LABEL'\n                )\n              }}\n              <woot-color-picker v-model=\"color\" />\n            </label>\n            <input-radio-group\n              name=\"widget-bubble-position\"\n              :label=\"\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_POSITION_LABEL'\n                )\n              \"\n              :items=\"widgetBubblePositions\"\n              :action=\"handleWidgetBubblePositionChange\"\n            />\n            <input-radio-group\n              name=\"widget-bubble-type\"\n              :label=\"\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_TYPE_LABEL'\n                )\n              \"\n              :items=\"widgetBubbleTypes\"\n              :action=\"handleWidgetBubbleTypeChange\"\n            />\n            <woot-input\n              v-model.trim=\"widgetBubbleLauncherTitle\"\n              :label=\"\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_LAUNCHER_TITLE.LABEL'\n                )\n              \"\n              :placeholder=\"\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_LAUNCHER_TITLE.PLACE_HOLDER'\n                )\n              \"\n            />\n            <woot-submit-button\n              class=\"submit-button\"\n              :button-text=\"\n                $t(\n                  'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.UPDATE.BUTTON_TEXT'\n                )\n              \"\n              :loading=\"uiFlags.isUpdating\"\n              :disabled=\"$v.$invalid || uiFlags.isUpdating\"\n            />\n          </form>\n        </div>\n      </div>\n      <div class=\"widget-container\">\n        <input-radio-group\n          name=\"widget-view-options\"\n          :items=\"getWidgetViewOptions\"\n          :action=\"handleWidgetViewChange\"\n          :style=\"{ 'text-align': 'center' }\"\n        />\n        <div v-if=\"isWidgetPreview\" class=\"widget-preview\">\n          <Widget\n            :welcome-heading=\"welcomeHeading\"\n            :welcome-tagline=\"welcomeTagline\"\n            :website-name=\"websiteName\"\n            :logo=\"avatarUrl\"\n            is-online\n            :reply-time=\"replyTime\"\n            :color=\"color\"\n            :widget-bubble-position=\"widgetBubblePosition\"\n            :widget-bubble-launcher-title=\"widgetBubbleLauncherTitle\"\n            :widget-bubble-type=\"widgetBubbleType\"\n          />\n        </div>\n        <div v-else class=\"widget-script\">\n          <woot-code :script=\"widgetScript\" />\n        </div>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport { mapGetters } from 'vuex';\nimport Widget from 'dashboard/modules/widget-preview/components/Widget';\nimport InputRadioGroup from './components/InputRadioGroup';\nimport alertMixin from 'shared/mixins/alertMixin';\nimport { required } from 'vuelidate/lib/validators';\nimport {\n  LocalStorage,\n  LOCAL_STORAGE_KEYS,\n} from 'dashboard/helper/localStorage';\n\nexport default {\n  components: {\n    Widget,\n    InputRadioGroup,\n  },\n  mixins: [alertMixin],\n  props: {\n    inbox: {\n      type: Object,\n      default: () => {},\n    },\n  },\n  data() {\n    return {\n      isWidgetPreview: true,\n      color: '#fc7658',\n      websiteName: '',\n      welcomeHeading: '',\n      welcomeTagline: '',\n      replyTime: 'in_a_few_minutes',\n      avatarFile: null,\n      avatarUrl: '',\n      widgetBubblePosition: 'right',\n      widgetBubbleLauncherTitle: this.$t(\n        'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_LAUNCHER_TITLE.DEFAULT'\n      ),\n      widgetBubbleType: 'standard',\n      widgetBubblePositions: [\n        {\n          id: 'left',\n          title: this.$t(\n            'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_POSITION.LEFT'\n          ),\n          checked: false,\n        },\n        {\n          id: 'right',\n          title: this.$t(\n            'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_POSITION.RIGHT'\n          ),\n          checked: true,\n        },\n      ],\n      widgetBubbleTypes: [\n        {\n          id: 'standard',\n          title: this.$t(\n            'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_TYPE.STANDARD'\n          ),\n          checked: true,\n        },\n        {\n          id: 'expanded_bubble',\n          title: this.$t(\n            'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_BUBBLE_TYPE.EXPANDED_BUBBLE'\n          ),\n          checked: false,\n        },\n      ],\n    };\n  },\n  computed: {\n    ...mapGetters({\n      uiFlags: 'inboxes/getUIFlags',\n    }),\n    storageKey() {\n      return `${LOCAL_STORAGE_KEYS.WIDGET_BUILDER}${this.inbox.id}`;\n    },\n    widgetScript() {\n      let options = {\n        position: this.widgetBubblePosition,\n        type: this.widgetBubbleType,\n        launcherTitle: this.widgetBubbleLauncherTitle,\n      };\n      let script = this.inbox.web_widget_script;\n      return (\n        script.substring(0, 13) +\n        this.$t('INBOX_MGMT.WIDGET_BUILDER.SCRIPT_SETTINGS', {\n          options: JSON.stringify(options),\n        }) +\n        script.substring(13)\n      );\n    },\n    getWidgetViewOptions() {\n      return [\n        {\n          id: 'preview',\n          title: this.$t(\n            'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_VIEW_OPTION.PREVIEW'\n          ),\n          checked: true,\n        },\n        {\n          id: 'script',\n          title: this.$t(\n            'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WIDGET_VIEW_OPTION.SCRIPT'\n          ),\n          checked: false,\n        },\n      ];\n    },\n    getReplyTimeOptions() {\n      return [\n        {\n          key: 'in_a_few_minutes',\n          value: 'in_a_few_minutes',\n          text: this.$t(\n            'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.REPLY_TIME.IN_A_FEW_MINUTES'\n          ),\n        },\n        {\n          key: 'in_a_few_hours',\n          value: 'in_a_few_hours',\n          text: this.$t(\n            'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.REPLY_TIME.IN_A_FEW_HOURS'\n          ),\n        },\n        {\n          key: 'in_a_day',\n          value: 'in_a_day',\n          text: this.$t(\n            'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.REPLY_TIME.IN_A_DAY'\n          ),\n        },\n      ];\n    },\n    websiteNameValidationErrorMsg() {\n      return this.$v.websiteName.$error\n        ? this.$t('INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.WEBSITE_NAME.ERROR')\n        : '';\n    },\n  },\n  mounted() {\n    this.setDefaults();\n  },\n  validations: {\n    websiteName: { required },\n  },\n  methods: {\n    setDefaults() {\n      // Widget Settings\n      const {\n        name,\n        welcome_title,\n        welcome_tagline,\n        widget_color,\n        reply_time,\n        avatar_url,\n      } = this.inbox;\n      this.websiteName = name;\n      this.welcomeHeading = welcome_title;\n      this.welcomeTagline = welcome_tagline;\n      this.color = widget_color;\n      this.replyTime = reply_time;\n      this.avatarUrl = avatar_url;\n\n      const savedInformation = this.getSavedInboxInformation();\n      if (savedInformation) {\n        this.widgetBubblePositions = this.widgetBubblePositions.map(item => {\n          if (item.id === savedInformation.position) {\n            item.checked = true;\n            this.widgetBubblePosition = item.id;\n          }\n          return item;\n        });\n        this.widgetBubbleTypes = this.widgetBubbleTypes.map(item => {\n          if (item.id === savedInformation.type) {\n            item.checked = true;\n            this.widgetBubbleType = item.id;\n          }\n          return item;\n        });\n        this.widgetBubbleLauncherTitle =\n          savedInformation.launcherTitle || 'Chat with us';\n      }\n    },\n    handleWidgetBubblePositionChange(item) {\n      this.widgetBubblePosition = item.id;\n    },\n    handleWidgetBubbleTypeChange(item) {\n      this.widgetBubbleType = item.id;\n    },\n    handleWidgetViewChange(item) {\n      this.isWidgetPreview = item.id === 'preview';\n    },\n    handleImageUpload({ file, url }) {\n      this.avatarFile = file;\n      this.avatarUrl = url;\n    },\n    async handleAvatarDelete() {\n      try {\n        await this.$store.dispatch('inboxes/deleteInboxAvatar', this.inbox.id);\n        this.avatarFile = null;\n        this.avatarUrl = '';\n        this.showAlert(\n          this.$t(\n            'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.AVATAR.DELETE.API.SUCCESS_MESSAGE'\n          )\n        );\n      } catch (error) {\n        this.showAlert(\n          error.message\n            ? error.message\n            : this.$t(\n                'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.AVATAR.DELETE.API.ERROR_MESSAGE'\n              )\n        );\n      }\n    },\n    async updateWidget() {\n      const bubbleSettings = {\n        position: this.widgetBubblePosition,\n        launcherTitle: this.widgetBubbleLauncherTitle,\n        type: this.widgetBubbleType,\n      };\n\n      LocalStorage.set(this.storageKey, bubbleSettings);\n\n      try {\n        const payload = {\n          id: this.inbox.id,\n          name: this.websiteName,\n          channel: {\n            widget_color: this.color,\n            welcome_title: this.welcomeHeading,\n            welcome_tagline: this.welcomeTagline,\n            reply_time: this.replyTime,\n          },\n        };\n        if (this.avatarFile) {\n          payload.avatar = this.avatarFile;\n        }\n        await this.$store.dispatch('inboxes/updateInbox', payload);\n        this.showAlert(\n          this.$t(\n            'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.UPDATE.API.SUCCESS_MESSAGE'\n          )\n        );\n      } catch (error) {\n        this.showAlert(\n          error.message ||\n            this.$t(\n              'INBOX_MGMT.WIDGET_BUILDER.WIDGET_OPTIONS.UPDATE.API.ERROR_MESSAGE'\n            )\n        );\n      }\n    },\n    getSavedInboxInformation() {\n      return LocalStorage.get(this.storageKey);\n    },\n  },\n};\n</script>\n\n<style lang=\"scss\" scoped>\n@import '~dashboard/assets/scss/woot';\n\n.widget-builder-conatiner {\n  display: flex;\n  flex-direction: row;\n  padding: var(--space-one);\n  @include breakpoint(900px down) {\n    flex-direction: column;\n  }\n}\n\n.settings-container {\n  width: 40%;\n  @include breakpoint(900px down) {\n    width: 100%;\n  }\n\n  .settings-content {\n    padding: var(--space-normal) var(--space-zero);\n    overflow-y: scroll;\n    min-height: 100%;\n\n    .submit-button {\n      margin-top: var(--space-normal);\n    }\n  }\n}\n\n.widget-container {\n  width: 60%;\n\n  @include breakpoint(900px down) {\n    width: 100%;\n  }\n\n  .widget-preview {\n    display: flex;\n    flex-direction: column;\n    align-items: center;\n    justify-content: flex-end;\n    min-height: 65rem;\n    margin: var(--space-zero) var(--space-two) var(--space-two) var(--space-two);\n    padding: var(--space-one) var(--space-one) var(--space-one) var(--space-one);\n    background: var(--s-50);\n\n    @include breakpoint(500px down) {\n      background: none;\n    }\n  }\n  .widget-script {\n    margin: 0 var(--space-two);\n    padding: var(--space-one);\n    background: var(--s-50);\n  }\n}\n</style>\n"],"sourceRoot":"app/javascript/dashboard/routes/dashboard/settings/inbox"},"metadata":{},"sourceType":"module"}