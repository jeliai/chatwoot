{"ast":null,"code":"\"use strict\";\n\nvar __importDefault = this && this.__importDefault || function (mod) {\n  return mod && mod.__esModule ? mod : {\n    \"default\": mod\n  };\n};\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.Identify = void 0;\n\nvar facade_1 = require(\"./facade\");\n\nvar obj_case_1 = __importDefault(require(\"obj-case\"));\n\nvar inherits_1 = __importDefault(require(\"inherits\"));\n\nvar is_email_1 = __importDefault(require(\"./is-email\"));\n\nvar new_date_1 = __importDefault(require(\"new-date\"));\n\nvar trim = function trim(str) {\n  return str.trim();\n};\n\nfunction Identify(dictionary, opts) {\n  facade_1.Facade.call(this, dictionary, opts);\n}\n\nexports.Identify = Identify;\ninherits_1.default(Identify, facade_1.Facade);\nvar i = Identify.prototype;\n\ni.action = function () {\n  return \"identify\";\n};\n\ni.type = i.action;\n\ni.traits = function (aliases) {\n  var ret = this.field(\"traits\") || {};\n  var id = this.userId();\n  aliases = aliases || {};\n  if (id) ret.id = id;\n\n  for (var alias in aliases) {\n    var value = this[alias] == null ? this.proxy(\"traits.\" + alias) : this[alias]();\n    if (value == null) continue;\n    ret[aliases[alias]] = value;\n    if (alias !== aliases[alias]) delete ret[alias];\n  }\n\n  return ret;\n};\n\ni.email = function () {\n  var email = this.proxy(\"traits.email\");\n  if (email) return email;\n  var userId = this.userId();\n  if (is_email_1.default(userId)) return userId;\n};\n\ni.created = function () {\n  var created = this.proxy(\"traits.created\") || this.proxy(\"traits.createdAt\");\n  if (created) return new_date_1.default(created);\n};\n\ni.companyCreated = function () {\n  var created = this.proxy(\"traits.company.created\") || this.proxy(\"traits.company.createdAt\");\n\n  if (created) {\n    return new_date_1.default(created);\n  }\n};\n\ni.companyName = function () {\n  return this.proxy(\"traits.company.name\");\n};\n\ni.name = function () {\n  var name = this.proxy(\"traits.name\");\n\n  if (typeof name === \"string\") {\n    return trim(name);\n  }\n\n  var firstName = this.firstName();\n  var lastName = this.lastName();\n\n  if (firstName && lastName) {\n    return trim(firstName + \" \" + lastName);\n  }\n};\n\ni.firstName = function () {\n  var firstName = this.proxy(\"traits.firstName\");\n\n  if (typeof firstName === \"string\") {\n    return trim(firstName);\n  }\n\n  var name = this.proxy(\"traits.name\");\n\n  if (typeof name === \"string\") {\n    return trim(name).split(\" \")[0];\n  }\n};\n\ni.lastName = function () {\n  var lastName = this.proxy(\"traits.lastName\");\n\n  if (typeof lastName === \"string\") {\n    return trim(lastName);\n  }\n\n  var name = this.proxy(\"traits.name\");\n\n  if (typeof name !== \"string\") {\n    return;\n  }\n\n  var space = trim(name).indexOf(\" \");\n\n  if (space === -1) {\n    return;\n  }\n\n  return trim(name.substr(space + 1));\n};\n\ni.uid = function () {\n  return this.userId() || this.username() || this.email();\n};\n\ni.description = function () {\n  return this.proxy(\"traits.description\") || this.proxy(\"traits.background\");\n};\n\ni.age = function () {\n  var date = this.birthday();\n  var age = obj_case_1.default(this.traits(), \"age\");\n  if (age != null) return age;\n  if (!(date instanceof Date)) return;\n  var now = new Date();\n  return now.getFullYear() - date.getFullYear();\n};\n\ni.avatar = function () {\n  var traits = this.traits();\n  return obj_case_1.default(traits, \"avatar\") || obj_case_1.default(traits, \"photoUrl\") || obj_case_1.default(traits, \"avatarUrl\");\n};\n\ni.position = function () {\n  var traits = this.traits();\n  return obj_case_1.default(traits, \"position\") || obj_case_1.default(traits, \"jobTitle\");\n};\n\ni.username = facade_1.Facade.proxy(\"traits.username\");\ni.website = facade_1.Facade.one(\"traits.website\");\ni.websites = facade_1.Facade.multi(\"traits.website\");\ni.phone = facade_1.Facade.one(\"traits.phone\");\ni.phones = facade_1.Facade.multi(\"traits.phone\");\ni.address = facade_1.Facade.proxy(\"traits.address\");\ni.gender = facade_1.Facade.proxy(\"traits.gender\");\ni.birthday = facade_1.Facade.proxy(\"traits.birthday\");","map":null,"metadata":{},"sourceType":"module"}