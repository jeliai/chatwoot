{"ast":null,"code":"import \"regenerator-runtime/runtime.js\";\n\nfunction asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }\n\nfunction _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"next\", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, \"throw\", err); } _next(undefined); }); }; }\n\nimport \"core-js/modules/es.number.constructor.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.promise.js\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport alertMixin from 'shared/mixins/alertMixin';\nimport { mixin as clickaway } from 'vue-clickaway';\nimport MacroPreview from './MacroPreview';\nimport AnalyticsHelper, { ANALYTICS_EVENTS } from '../../../../helper/AnalyticsHelper';\nexport default {\n  components: {\n    MacroPreview: MacroPreview\n  },\n  mixins: [alertMixin, clickaway],\n  props: {\n    macro: {\n      type: Object,\n      required: true\n    },\n    conversationId: {\n      type: [Number, String],\n      required: true\n    }\n  },\n  data: function data() {\n    return {\n      isExecuting: false,\n      showPreview: false\n    };\n  },\n  methods: {\n    executeMacro: function executeMacro(macro) {\n      var _this = this;\n\n      return _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {\n        return regeneratorRuntime.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _this.isExecuting = true;\n                _context.next = 4;\n                return _this.$store.dispatch('macros/execute', {\n                  macroId: macro.id,\n                  conversationIds: [_this.conversationId]\n                });\n\n              case 4:\n                AnalyticsHelper.track(ANALYTICS_EVENTS.EXECUTED_A_MACRO);\n\n                _this.showAlert(_this.$t('MACROS.EXECUTE.EXECUTED_SUCCESSFULLY'));\n\n                _context.next = 11;\n                break;\n\n              case 8:\n                _context.prev = 8;\n                _context.t0 = _context[\"catch\"](0);\n\n                _this.showAlert(_this.$t('MACROS.ERROR'));\n\n              case 11:\n                _context.prev = 11;\n                _this.isExecuting = false;\n                return _context.finish(11);\n\n              case 14:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, null, [[0, 8, 11, 14]]);\n      }))();\n    },\n    toggleMacroPreview: function toggleMacroPreview() {\n      this.showPreview = !this.showPreview;\n    },\n    closeMacroPreview: function closeMacroPreview() {\n      this.showPreview = false;\n    }\n  }\n};","map":{"version":3,"sources":["MacroItem.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAkCA,OAAA,UAAA,MAAA,0BAAA;AACA,SAAA,KAAA,IAAA,SAAA,QAAA,eAAA;AACA,OAAA,YAAA,MAAA,gBAAA;AACA,OAAA,eAAA,IACA,gBADA,QAEA,oCAFA;AAGA,eAAA;AACA,EAAA,UAAA,EAAA;AACA,IAAA,YAAA,EAAA;AADA,GADA;AAIA,EAAA,MAAA,EAAA,CAAA,UAAA,EAAA,SAAA,CAJA;AAKA,EAAA,KAAA,EAAA;AACA,IAAA,KAAA,EAAA;AACA,MAAA,IAAA,EAAA,MADA;AAEA,MAAA,QAAA,EAAA;AAFA,KADA;AAKA,IAAA,cAAA,EAAA;AACA,MAAA,IAAA,EAAA,CAAA,MAAA,EAAA,MAAA,CADA;AAEA,MAAA,QAAA,EAAA;AAFA;AALA,GALA;AAeA,EAAA,IAfA,kBAeA;AACA,WAAA;AACA,MAAA,WAAA,EAAA,KADA;AAEA,MAAA,WAAA,EAAA;AAFA,KAAA;AAIA,GApBA;AAqBA,EAAA,OAAA,EAAA;AACA,IAAA,YADA,wBACA,KADA,EACA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAEA,gBAAA,KAAA,CAAA,WAAA,GAAA,IAAA;AAFA;AAAA,uBAGA,KAAA,CAAA,MAAA,CAAA,QAAA,CAAA,gBAAA,EAAA;AACA,kBAAA,OAAA,EAAA,KAAA,CAAA,EADA;AAEA,kBAAA,eAAA,EAAA,CAAA,KAAA,CAAA,cAAA;AAFA,iBAAA,CAHA;;AAAA;AAOA,gBAAA,eAAA,CAAA,KAAA,CAAA,gBAAA,CAAA,gBAAA;;AACA,gBAAA,KAAA,CAAA,SAAA,CAAA,KAAA,CAAA,EAAA,CAAA,sCAAA,CAAA;;AARA;AAAA;;AAAA;AAAA;AAAA;;AAUA,gBAAA,KAAA,CAAA,SAAA,CAAA,KAAA,CAAA,EAAA,CAAA,cAAA,CAAA;;AAVA;AAAA;AAYA,gBAAA,KAAA,CAAA,WAAA,GAAA,KAAA;AAZA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAcA,KAfA;AAgBA,IAAA,kBAhBA,gCAgBA;AACA,WAAA,WAAA,GAAA,CAAA,KAAA,WAAA;AACA,KAlBA;AAmBA,IAAA,iBAnBA,+BAmBA;AACA,WAAA,WAAA,GAAA,KAAA;AACA;AArBA;AArBA,CAAA","sourcesContent":["<template>\n  <div class=\"macro\">\n    <span class=\"text-truncate\">{{ macro.name }}</span>\n    <div class=\"macros-actions\">\n      <woot-button\n        v-tooltip.left-start=\"$t('MACROS.EXECUTE.PREVIEW')\"\n        size=\"tiny\"\n        variant=\"smooth\"\n        color-scheme=\"secondary\"\n        icon=\"info\"\n        class=\"margin-right-smaller\"\n        @click=\"toggleMacroPreview(macro)\"\n      />\n      <woot-button\n        v-tooltip.left-start=\"$t('MACROS.EXECUTE.BUTTON_TOOLTIP')\"\n        size=\"tiny\"\n        variant=\"smooth\"\n        color-scheme=\"secondary\"\n        icon=\"play-circle\"\n        :is-loading=\"isExecuting\"\n        @click=\"executeMacro(macro)\"\n      />\n    </div>\n    <transition name=\"menu-slide\">\n      <macro-preview\n        v-if=\"showPreview\"\n        v-on-clickaway=\"closeMacroPreview\"\n        :macro=\"macro\"\n      />\n    </transition>\n  </div>\n</template>\n\n<script>\nimport alertMixin from 'shared/mixins/alertMixin';\nimport { mixin as clickaway } from 'vue-clickaway';\nimport MacroPreview from './MacroPreview';\nimport AnalyticsHelper, {\n  ANALYTICS_EVENTS,\n} from '../../../../helper/AnalyticsHelper';\nexport default {\n  components: {\n    MacroPreview,\n  },\n  mixins: [alertMixin, clickaway],\n  props: {\n    macro: {\n      type: Object,\n      required: true,\n    },\n    conversationId: {\n      type: [Number, String],\n      required: true,\n    },\n  },\n  data() {\n    return {\n      isExecuting: false,\n      showPreview: false,\n    };\n  },\n  methods: {\n    async executeMacro(macro) {\n      try {\n        this.isExecuting = true;\n        await this.$store.dispatch('macros/execute', {\n          macroId: macro.id,\n          conversationIds: [this.conversationId],\n        });\n        AnalyticsHelper.track(ANALYTICS_EVENTS.EXECUTED_A_MACRO);\n        this.showAlert(this.$t('MACROS.EXECUTE.EXECUTED_SUCCESSFULLY'));\n      } catch (error) {\n        this.showAlert(this.$t('MACROS.ERROR'));\n      } finally {\n        this.isExecuting = false;\n      }\n    },\n    toggleMacroPreview() {\n      this.showPreview = !this.showPreview;\n    },\n    closeMacroPreview() {\n      this.showPreview = false;\n    },\n  },\n};\n</script>\n\n<style scoped lang=\"scss\">\n.macro {\n  position: relative;\n  display: flex;\n  align-items: center;\n  justify-content: space-between;\n  margin: 0;\n  padding: var(--space-small);\n  font-weight: var(--font-weight-medium);\n  border-radius: var(--border-radius-normal);\n  color: var(--s-700);\n\n  &:hover {\n    background: var(--s-25);\n    color: var(--s-600);\n  }\n\n  &:focus {\n    border-color: var(--w-300);\n  }\n\n  .macros-actions {\n    display: flex;\n    align-items: center;\n    justify-content: flex-end;\n  }\n}\n</style>\n"],"sourceRoot":"app/javascript/dashboard/routes/dashboard/conversation/Macros"},"metadata":{},"sourceType":"module"}