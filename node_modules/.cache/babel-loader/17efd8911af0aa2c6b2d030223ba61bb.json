{"ast":null,"code":"import { embeddedWriteKey } from './embedded-write-key';\nvar regex = /(https:\\/\\/.*)\\/analytics\\.js\\/v1\\/(?:.*?)\\/(?:platform|analytics.*)?/;\nexport function getCDN() {\n  var cdn = undefined;\n  var scripts = Array.prototype.slice.call(document.querySelectorAll('script'));\n  scripts.forEach(function (s) {\n    var _a;\n\n    var src = (_a = s.getAttribute('src')) !== null && _a !== void 0 ? _a : '';\n    var result = regex.exec(src);\n\n    if (result && result[1]) {\n      cdn = result[1];\n    }\n  }); // it's possible that the CDN is not found in the page because:\n  // - the script is loaded through a proxy\n  // - the script is removed after execution\n  // in this case, we fall back to the default Segment CDN\n\n  if (!cdn) {\n    return \"https://cdn.segment.com\";\n  }\n\n  return cdn;\n}\n/**\n * Replaces the CDN URL in the script tag with the one from Analytics.js 1.0\n *\n * @returns the path to Analytics JS 1.0\n **/\n\nexport function getLegacyAJSPath() {\n  var _a, _b;\n\n  var writeKey = (_a = embeddedWriteKey()) !== null && _a !== void 0 ? _a : window.analytics._writeKey;\n  var scripts = Array.prototype.slice.call(document.querySelectorAll('script'));\n  var path = undefined;\n\n  for (var _i = 0, scripts_1 = scripts; _i < scripts_1.length; _i++) {\n    var s = scripts_1[_i];\n    var src = (_b = s.getAttribute('src')) !== null && _b !== void 0 ? _b : '';\n    var result = regex.exec(src);\n\n    if (result && result[1]) {\n      path = src;\n      break;\n    }\n  }\n\n  if (path) {\n    return path.replace('analytics.min.js', 'analytics.classic.js');\n  }\n\n  return \"https://cdn.segment.com/analytics.js/v1/\" + writeKey + \"/analytics.classic.js\";\n}","map":null,"metadata":{},"sourceType":"module"}