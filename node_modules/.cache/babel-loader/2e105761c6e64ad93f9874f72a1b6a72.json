{"ast":null,"code":"function ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(Object(source), true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(Object(source)).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nfunction _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }\n\nimport \"core-js/modules/es.regexp.exec.js\";\nimport \"core-js/modules/es.string.search.js\";\nimport \"core-js/modules/es.object.to-string.js\";\nimport \"core-js/modules/es.regexp.to-string.js\";\nimport \"core-js/modules/es.function.name.js\";\nimport \"core-js/modules/es.array.concat.js\";\nimport \"core-js/modules/es.object.keys.js\";\nimport \"core-js/modules/es.symbol.js\";\nimport \"core-js/modules/es.array.filter.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptor.js\";\nimport \"core-js/modules/web.dom-collections.for-each.js\";\nimport \"core-js/modules/es.object.get-own-property-descriptors.js\";\nimport { buildSearchParamsWithLocale } from '../helpers/urlParamsHelper';\nimport { generateEventParams } from './events';\n\nvar createConversation = function createConversation(params) {\n  var referrerURL = window.referrerURL || '';\n  var search = buildSearchParamsWithLocale(window.location.search);\n  return {\n    url: \"/api/v1/widget/conversations\".concat(search),\n    params: {\n      contact: {\n        name: params.fullName,\n        email: params.emailAddress,\n        phone_number: params.phoneNumber\n      },\n      message: {\n        content: params.message,\n        timestamp: new Date().toString(),\n        referer_url: referrerURL\n      },\n      custom_attributes: params.customAttributes\n    }\n  };\n};\n\nvar sendMessage = function sendMessage(content) {\n  var referrerURL = window.referrerURL || '';\n  var search = buildSearchParamsWithLocale(window.location.search);\n  return {\n    url: \"/api/v1/widget/messages\".concat(search),\n    params: {\n      message: {\n        content: content,\n        timestamp: new Date().toString(),\n        referer_url: referrerURL\n      }\n    }\n  };\n};\n\nvar sendAttachment = function sendAttachment(_ref) {\n  var attachment = _ref.attachment;\n  var _window = window,\n      _window$referrerURL = _window.referrerURL,\n      referrerURL = _window$referrerURL === void 0 ? '' : _window$referrerURL;\n  var timestamp = new Date().toString();\n  var file = attachment.file;\n  var formData = new FormData();\n\n  if (typeof file === 'string') {\n    formData.append('message[attachments][]', file);\n  } else {\n    formData.append('message[attachments][]', file, file.name);\n  }\n\n  formData.append('message[referer_url]', referrerURL);\n  formData.append('message[timestamp]', timestamp);\n  return {\n    url: \"/api/v1/widget/messages\".concat(window.location.search),\n    params: formData\n  };\n};\n\nvar getConversation = function getConversation(_ref2) {\n  var before = _ref2.before;\n  return {\n    url: \"/api/v1/widget/messages\".concat(window.location.search),\n    params: {\n      before: before\n    }\n  };\n};\n\nvar updateMessage = function updateMessage(id) {\n  return {\n    url: \"/api/v1/widget/messages/\".concat(id).concat(window.location.search)\n  };\n};\n\nvar getAvailableAgents = function getAvailableAgents(token) {\n  return {\n    url: '/api/v1/widget/inbox_members',\n    params: {\n      website_token: token\n    }\n  };\n};\n\nvar getCampaigns = function getCampaigns(token) {\n  return {\n    url: '/api/v1/widget/campaigns',\n    params: {\n      website_token: token\n    }\n  };\n};\n\nvar triggerCampaign = function triggerCampaign(_ref3) {\n  var websiteToken = _ref3.websiteToken,\n      campaignId = _ref3.campaignId,\n      customAttributes = _ref3.customAttributes;\n  return {\n    url: '/api/v1/widget/events',\n    data: {\n      name: 'campaign.triggered',\n      event_info: _objectSpread({\n        campaign_id: campaignId,\n        custom_attributes: customAttributes\n      }, generateEventParams())\n    },\n    params: {\n      website_token: websiteToken\n    }\n  };\n};\n\nexport default {\n  createConversation: createConversation,\n  sendMessage: sendMessage,\n  sendAttachment: sendAttachment,\n  getConversation: getConversation,\n  updateMessage: updateMessage,\n  getAvailableAgents: getAvailableAgents,\n  getCampaigns: getCampaigns,\n  triggerCampaign: triggerCampaign\n};","map":{"version":3,"sources":["/Users/s.dastan/Desktop/chatwoot/chatwoot/app/javascript/widget/api/endPoints.js"],"names":["buildSearchParamsWithLocale","generateEventParams","createConversation","params","referrerURL","window","search","location","url","contact","name","fullName","email","emailAddress","phone_number","phoneNumber","message","content","timestamp","Date","toString","referer_url","custom_attributes","customAttributes","sendMessage","sendAttachment","attachment","file","formData","FormData","append","getConversation","before","updateMessage","id","getAvailableAgents","token","website_token","getCampaigns","triggerCampaign","websiteToken","campaignId","data","event_info","campaign_id"],"mappings":"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","sourcesContent":["import { buildSearchParamsWithLocale } from '../helpers/urlParamsHelper';\nimport { generateEventParams } from './events';\n\nconst createConversation = params => {\n  const referrerURL = window.referrerURL || '';\n  const search = buildSearchParamsWithLocale(window.location.search);\n  return {\n    url: `/api/v1/widget/conversations${search}`,\n    params: {\n      contact: {\n        name: params.fullName,\n        email: params.emailAddress,\n        phone_number: params.phoneNumber,\n      },\n      message: {\n        content: params.message,\n        timestamp: new Date().toString(),\n        referer_url: referrerURL,\n      },\n      custom_attributes: params.customAttributes,\n    },\n  };\n};\n\nconst sendMessage = content => {\n  const referrerURL = window.referrerURL || '';\n  const search = buildSearchParamsWithLocale(window.location.search);\n  return {\n    url: `/api/v1/widget/messages${search}`,\n    params: {\n      message: {\n        content,\n        timestamp: new Date().toString(),\n        referer_url: referrerURL,\n      },\n    },\n  };\n};\n\nconst sendAttachment = ({ attachment }) => {\n  const { referrerURL = '' } = window;\n  const timestamp = new Date().toString();\n  const { file } = attachment;\n\n  const formData = new FormData();\n  if (typeof file === 'string') {\n    formData.append('message[attachments][]', file);\n  } else {\n    formData.append('message[attachments][]', file, file.name);\n  }\n\n  formData.append('message[referer_url]', referrerURL);\n  formData.append('message[timestamp]', timestamp);\n  return {\n    url: `/api/v1/widget/messages${window.location.search}`,\n    params: formData,\n  };\n};\n\nconst getConversation = ({ before }) => ({\n  url: `/api/v1/widget/messages${window.location.search}`,\n  params: { before },\n});\n\nconst updateMessage = id => ({\n  url: `/api/v1/widget/messages/${id}${window.location.search}`,\n});\n\nconst getAvailableAgents = token => ({\n  url: '/api/v1/widget/inbox_members',\n  params: {\n    website_token: token,\n  },\n});\nconst getCampaigns = token => ({\n  url: '/api/v1/widget/campaigns',\n  params: {\n    website_token: token,\n  },\n});\nconst triggerCampaign = ({ websiteToken, campaignId, customAttributes }) => ({\n  url: '/api/v1/widget/events',\n  data: {\n    name: 'campaign.triggered',\n    event_info: {\n      campaign_id: campaignId,\n      custom_attributes: customAttributes,\n      ...generateEventParams(),\n    },\n  },\n  params: {\n    website_token: websiteToken,\n  },\n});\n\nexport default {\n  createConversation,\n  sendMessage,\n  sendAttachment,\n  getConversation,\n  updateMessage,\n  getAvailableAgents,\n  getCampaigns,\n  triggerCampaign,\n};\n"]},"metadata":{},"sourceType":"module"}