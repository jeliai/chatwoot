"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var tslib_1 = require("tslib");
var jsdom_1 = require("jsdom");
var analytics_1 = require("../../../analytics");
var index_1 = require("../index");
beforeEach(function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
    var html, jsd, windowSpy;
    return tslib_1.__generator(this, function (_a) {
        jest.restoreAllMocks();
        jest.resetAllMocks();
        html = "\n    <!DOCTYPE html>\n      <head>\n        <script>\n          'hi'\n        </script>\n      </head>\n      <body>\n      </body>\n    </html>\n    ".trim();
        jsd = new jsdom_1.JSDOM(html, {
            runScripts: 'dangerously',
            resources: 'usable',
        });
        windowSpy = jest.spyOn(global, 'window', 'get');
        windowSpy.mockImplementation(function () {
            return jsd.window;
        });
        return [2 /*return*/];
    });
}); });
describe(index_1.loadLegacyVideoPlugins.name, function () {
    it('attaches video plugins to ajs', function () { return tslib_1.__awaiter(void 0, void 0, void 0, function () {
        var ajs;
        return tslib_1.__generator(this, function (_a) {
            switch (_a.label) {
                case 0:
                    console.warn = function () { };
                    ajs = new analytics_1.Analytics({
                        writeKey: 'w_123',
                    });
                    return [4 /*yield*/, index_1.loadLegacyVideoPlugins(ajs)];
                case 1:
                    _a.sent();
                    expect(ajs.plugins).toMatchInlineSnapshot("\n      Object {\n        \"VimeoAnalytics\": [Function],\n        \"YouTubeAnalytics\": [Function],\n      }\n    ");
                    return [2 /*return*/];
            }
        });
    }); });
});
//# sourceMappingURL=index.test.js.map